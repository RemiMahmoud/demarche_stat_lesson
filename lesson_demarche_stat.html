<!DOCTYPE html>
<html lang="en"><head>
<script src="lesson_demarche_stat_files/libs/clipboard/clipboard.min.js"></script>
<script src="lesson_demarche_stat_files/libs/quarto-html/tabby.min.js"></script>
<script src="lesson_demarche_stat_files/libs/quarto-html/popper.min.js"></script>
<script src="lesson_demarche_stat_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lesson_demarche_stat_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lesson_demarche_stat_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lesson_demarche_stat_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lesson_demarche_stat_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="lesson_demarche_stat_files/libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="lesson_demarche_stat_files/libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="lesson_demarche_stat_files/libs/quarto-contrib/bootstrap-icons-1.11.1/all.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.555">

  <meta name="author" content="Rémi Mahmoud">
  <title>Démarche statistique</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lesson_demarche_stat_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lesson_demarche_stat_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lesson_demarche_stat_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="lesson_demarche_stat_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lesson_demarche_stat_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lesson_demarche_stat_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lesson_demarche_stat_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Démarche statistique</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Rémi Mahmoud 
</div>
</div>
</div>

  <p class="date">remi.mahmoud@agrocampus-ouest.fr <br> https://demarche-stat-lesson.netlify.app</p>
</section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>
<section id="objectifs" class="slide level2" style="font-size: 140%;">
<h2>Objectifs</h2>
<div class="cell">
<style type="text/css">

</style>
</div>
<ul>
<li>Aborder les problèmes courants en analyse de données</li>
<li>Argumenter le choix de procédures d’analyses</li>
<li>Mettre en oeuvre une démarche d’analyse de données avec <img data-src="images/R_logo.svg.png" class="quarto-figure quarto-figure-center" style="width:5.0%"></li>
<li>Interpréter &amp; restituer les résultats d’une analyse</li>
</ul>
<div class="fragment">
<p>On attend:</p>
<div class="columns">
<div class="column" style="width:33%;">
<p><strong>Attention</strong></p>
<p><i class="fa-solid fa-ear-listen fa-2xl" aria-label="ear-listen"></i></p>
</div><div class="column" style="width:33%;">
<p><strong>Réflexion</strong></p>
<p><i class="fa-solid fa-brain fa-2xl" aria-label="brain"></i></p>
</div><div class="column" style="width:33%;">
<p><strong>Participation</strong></p>
<p><i class="fa-solid fa-question fa-2xl" aria-label="question"></i></p>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Evaluation:</strong></p>
<p>2 CC (50%) + 1 projet (50%)</p>
</div>
</section>
<section id="quelques-définitions-wiki" class="slide level2">
<h2>Quelques définitions (Wiki)</h2>
<ul>
<li><p><strong><em>LA</em></strong> <strong>statistique</strong>: discipline qui étudie les phénomènes à travers la collecte de <strong>données</strong>, leur traitement, leur analyse, l’interprétation et la présentation des résultats […]. <strong>Domaine des mathématiques + boîte à outils</strong>. Fait partie de la <strong>science des données</strong></p></li>
<li><p><strong><em>LES</em></strong> <strong>statistiques</strong>: type d’information obtenu en soumettant les valeurs à des opérations mathématiques.</p></li>
<li><p><strong>L’analyse des données</strong>: Famille de méthodes statistiques dont les principales caractéristiques sont d’être multidimensionnelles et descriptives.</p></li>
</ul>
<p><i class="fa-solid fa-triangle-exclamation" aria-label="triangle-exclamation"></i>: en anglais, <em>data analysis</em> <span class="math inline">\(\Leftrightarrow\)</span> Statistique</p>
<div class="fragment">
<p><strong>En résumé</strong></p>
<p>La statistique s’intéresse à des jeux de données de taille raisonnable, fréquents dans vos domaines.</p>
</div>
</section>
<section id="les-statistiques-sont-utilisées-partout" class="slide level2">
<h2>Les statistiques sont (utilisées) partout</h2>
<div class="r-stack">
<div class="quarto-layout-panel" data-layout-nrow="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img data-src="images/co2_rich.PNG" class="fragment" style="width:80.0%"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img data-src="images/covid_groupe_sanguin.PNG" class="fragment" style="width:80.0%"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img data-src="images/figaro.PNG" class="fragment" style="width:80.0%"></p>
</div>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>En cela elles sont un outil <em>politique</em>, traduisant une certaine vision du monde et à manipuler avec précaution.</li>
</ul>
</div>
</section>
<section id="coeur-de-la-statistique" class="slide level2">
<h2>Coeur de la statistique</h2>
<ul>
<li>Avoir les <em>bonnes</em> données:
<ul>
<li>observations d’un phénomène</li>
<li>sont-elles représentatives ?</li>
</ul></li>
</ul>
<div class="fragment">
<p>Ex. où renforcer l’avion ?</p>
<div class="r-stack">
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/Survivorship-bias.svg" class="fragment" width="250" height="200"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/bezos.PNG" class="fragment" width="450" height="200"></p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><p>Les résumer, les visualiser</p></li>
<li><p>Se poser des questions:</p>
<ul>
<li>Ex. pollution aux algues vertes: quelle variable utiliser ? Surface ? Masse ? Où/Quand/Comment faire des recueils ?</li>
<li>Cause / Conséquence (variété de blé / Rendement ; utilisation de phyto / diversité entomologique ; complexité du paysage)</li>
<li>Variables <strong>explicatives</strong> vs variable(s) <strong>réponse(s)</strong></li>
</ul></li>
</ul>
</div>
</section>
<section class="slide level2">

<ul>
<li>Tous les effets ont-ils été pris en compte ?</li>
</ul>
<div class="fragment">
<p>Ex. <strong>paradoxe de Simpson</strong> (<a href="https://www.youtube.com/watch?v=vs_Zzf_vL2I&amp;ab_channel=ScienceEtonnante" style="color:blue;">Vidéo complète sur le sujet</a> de Science Etonnante)</p>
<div class="r-stack">
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/death_rate_all.png" class="fragment" style="width:100.0%"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/death_rate_by_age.png" class="fragment" style="width:100.0%"></p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/size_sample.png" class="quarto-figure quarto-figure-center" style="width:40.0%"></p>
</figure>
</div>
</div>
</section>
<section id="outil-r-moteur-rstudio-carrosserie" class="slide level2 scrollable">
<h2>Outil: R (moteur) / Rstudio (carrosserie)</h2>
<ul>
<li>Gratuit/libre/multi-plateforme</li>
<li>Nombreux (+++) domaines d’applications (ex. ce cours a été réalisé sous R)</li>
<li>BEAUCOUP d’aide dispo</li>
</ul>
<div class="fragment">
<p><strong>Installation:</strong></p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ol type="1">
<li>Télécharger et installer le <strong>moteur</strong> <img data-src="images/R_logo.svg.png" style="width:10.0%"> <span class="math inline">\(\rightarrow\)</span> <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a></li>
</ol>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ol start="2" type="1">
<li>Télécharger et installer la <strong>carrosserie</strong> <img data-src="images/rstudio_logo.png" style="width:20.0%"></li>
</ol>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>On peut aussi dessiner avec R (mais c’est une autre histoire)</p>
<div id="fig-casa" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-casa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-casa" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ridge" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-ridge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="images/casa_1.png" data-ref-parent="fig-casa" height="150">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ridge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Ridge
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-casa" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-collatz" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-collatz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="images/casa_2.png" data-ref-parent="fig-casa" height="150">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-collatz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Collatz
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-casa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <a href="https://art.casadebaig.net/">Pierre Casadebaig</a>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="quelques-définitions-12" class="slide level2">
<h2>Quelques définitions (1/2)</h2>
<ul>
<li><p><strong>Population</strong>: ensemble d’entités objet de l’investigation statistique</p></li>
<li><p><strong>Individu</strong>: élément de la population d’étude</p></li>
<li><p><strong>Echantillon</strong>: ensemble des individus pour lesquels des valeurs ont été observées pour les variables de l’étude</p></li>
<li><p><strong>Variable</strong>: descripteur ou caractère des individus de la population d’étude</p></li>
<li><p><strong>Inférence</strong>: décider pour une population à partir des données observées de l’échantillon</p></li>
</ul>
<div class="r-stack">
<p><img data-src="images/plot_population.png" class="fragment"></p>
<p><img data-src="images/plot_population_and_sample.png" class="fragment"></p>
<p><img data-src="images/plot_population_and_sample_inference.png" class="fragment"></p>
</div>
</section>
<section id="quelques-définitions-22" class="slide level2">
<h2>Quelques définitions (2/2)</h2>
<div style="font-size: 140%;">
<p><strong>Nature des variables</strong>:</p>
<ul>
<li>Qualitatives : les valeurs prises sont des <em>modalités</em>
<ul>
<li>nominale : pas de structure d’ordre <i class="fa-solid fa-flag fa-1xl" aria-label="flag"></i></li>
<li>ordinale : modalités ordonnées <i class="fa-solid fa-ranking-star fa-1xl" aria-label="ranking-star"></i></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div style="font-size: 140%;">
<ul>
<li>quantitative: les valeurs prises sont <em>numériques</em>
<ul>
<li>discrete <i class="fa-solid fa-arrow-up-9-1 fa-1.5xl" aria-label="arrow-up-9-1"></i> <i class="fa-solid fa-child fa-1xl" aria-label="child"></i> <i class="fa-solid fa-fish fa-1xl" aria-label="fish"></i></li>
<li>continue <i class="fa-solid fa-weight-scale fa-1xl" aria-label="weight-scale"></i> <em>$</em></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="décrire-les-données-à-laide-dindicateurs" class="slide level2">
<h2>Décrire les données à l’aide d’indicateurs</h2>
<div style="font-size: 85%;">
<p>Soit <span class="math inline">\(x_1, x_2, ..., x_n\)</span> une série de <span class="math inline">\(n\)</span> valeurs d’une variable X. On peut les décrire en utilisant des indicateurs de <span style="color:blue;">position</span> et de <span style="color:red;">dispersion</span> (que vous connaissez probablement)</p>
<ul>
<li><span style="color:blue;">moyenne:</span> <span class="math inline">\(\color{blue}{\bar{x} = \frac{1}{n} \sum x_i = \frac{x_1 + x_2 + ... + x_n}{n}}\)</span></li>
<li><span style="color:blue;">médiane:</span> <span class="math inline">\(\color{blue}{q_{0.5}(x) = }\)</span> valeur telle que 50% des <span class="math inline">\(x_i\)</span> ont une valeur inférieure et 50% une valeur supérieure</li>
<li><span style="color:blue;">1er quartile:</span> <span class="math inline">\(\color{blue}{q_{0.25}(x) = }\)</span> valeur telle que 25% des <span class="math inline">\(x_i\)</span> ont une valeur inférieure et 75% une valeur supérieure</li>
<li><span style="color:blue;">3ème quartile:</span> <span class="math inline">\(\color{blue}{q_{0.75}(x) = }\)</span> valeur telle que 75% des <span class="math inline">\(x_i\)</span> ont une valeur inférieure et 25% une valeur supérieure</li>
<li><span style="color:blue;">quantile <span class="math inline">\(\alpha\)</span>:</span> <span class="math inline">\(\color{blue}{q_\alpha(x) = }\)</span> valeur telle que <span class="math inline">\(100 \times \alpha\)</span> % des <span class="math inline">\(x_i\)</span> ont une valeur inférieure et <span class="math inline">\(100 - 100 \times \alpha\)</span>% une valeur supérieure</li>
<li><span style="color:red;">variance:</span> <span class="math inline">\(\color{red}{s^2(x) = \hat{\sigma}^2(x) = \frac{1}{n-1}  \sum (x_i - \bar{x})^2}\)</span></li>
<li><span style="color:red;">écart-type:</span> <span class="math inline">\(\color{red}{s(x) = \sqrt{s^2(x)}}\)</span></li>
</ul>
</div>

<img data-src="images/plot_descriptors.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="un-jeu-de-données-comme-fil-conducteur" class="slide level2">
<h2>Un jeu de données comme fil conducteur</h2>
<p>L’association Air Breizh surveille la qualité de l’air et mesure la concentration de polluants comme l’ozone (O3) ainsi que les conditions météorologiques comme la température, la nébulosité, le vent, etc. Durant l’été 2001, 112 données ont été relevées à Rennes.</p>
<div class="cell my_class_code">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>ozone <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"https://r-stat-sc-donnees.github.io/ozone.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="fu">head</span>(ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         maxO3   T9  T12  T15 Ne9 Ne12 Ne15     Vx9    Vx12    Vx15 maxO3v
20010601    87 15.6 18.5 18.4   4    4    8  0.6946 -1.7101 -0.6946     84
20010602    82 17.0 18.4 17.7   5    5    7 -4.3301 -4.0000 -3.0000     87
20010603    92 15.3 17.6 19.5   2    5    4  2.9544  1.8794  0.5209     82
20010604   114 16.2 19.7 22.5   1    1    0  0.9848  0.3473 -0.1736     92
20010605    94 17.4 20.5 20.4   8    8    7 -0.5000 -2.9544 -4.3301    114
20010606    80 17.7 19.8 18.3   6    6    7 -5.6382 -5.0000 -6.0000     94
          vent pluie
20010601  Nord   Sec
20010602  Nord   Sec
20010603   Est   Sec
20010604  Nord   Sec
20010605 Ouest   Sec
20010606 Ouest Pluie</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>Une question:</strong></p>
<ul>
<li>Peut-on prévoir la concentration en ozone du lendemain pour avertir la population en cas de pic de pollution ?</li>
</ul>
</div>
</section></section>
<section>
<section id="visualisation" class="title-slide slide level1 center">
<h1>Visualisation</h1>

</section>
<section id="la-visualisation-pourquoi" class="slide level2">
<h2>La visualisation: pourquoi ?</h2>
<ul>
<li>Quels points communs entre ces 4 jeux de données ?</li>
</ul>
<div class="r-stack">
<p><img data-src="images/anscombe_quartet.png" class="fragment" width="700" height="450"></p>
<p><img data-src="images/anscombe_quartet_answer.png" class="fragment" width="700" height="450"></p>
</div>
</section>
<section id="visualisation-quels-choix" class="slide level2">
<h2>Visualisation: quels choix ?</h2>
<ul>
<li>La visualisation dépend de:
<ul>
<li><p>La nature des données (nature des variables, nb d’individus)</p></li>
<li><p>La problématique: qu’est-ce que je veux montrer ?</p></li>
<li><p><a href="https://www.data-to-viz.com/" style="color:blue;">le site data-to-viz.com</a> permet de trouver de bonnes idées</p></li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li>La visualisation permet de:
<ul>
<li>comprendre / explorer / vérifier les données</li>
<li>suggérer des analyses</li>
<li><em>faire passer des idées</em></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p><strong>Les graphiques sont ce qu’on retient de nombreux rapports / analyses / articles scientifiques.</strong></p>
</div>
<div class="fragment">
<p>Sur <img data-src="images/R_logo.svg.png" class="quarto-figure quarto-figure-center" style="width:5.0%">, le package <code>ggplot2</code> permet de faire des visualisations allant du plus simple au plus compliqué.</p>
</div>
</section>
<section id="ggplot---quick-tuto" class="slide level2">
<h2>GGplot - Quick tuto</h2>
<div class="fragment">
<p><img data-src="images/building_blocks_ggplot.png"></p>
</div>
</section>
<section id="ggplot---exemple-distribution-dune-variable-quantitative" class="slide level2">
<h2>GGplot - Exemple: distribution d’une variable quantitative</h2>
<!-- code-line-numbers="|6|9" -->
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="fu">ggplot</span>(ozone) <span class="co"># création de l'objet ggplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="ggplot---exemple-distribution-dune-variable-quantitative-1" class="slide level2" data-transition="none">
<h2>GGplot - Exemple: distribution d’une variable quantitative</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> maxO3)) <span class="sc">+</span> <span class="co"># création de l'objet ggplot, en spécifiant ce qu'on veut en x</span></span>
<span id="cb4-2"><a href=""></a>  <span class="fu">geom_histogram</span>() <span class="co"># ajout d'une couche HISTOGRAMME </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="ggplot---exemple-distribution-dune-variable-quantitative-2" class="slide level2" data-transition="none">
<h2>GGplot - Exemple: distribution d’une variable quantitative</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> maxO3)) <span class="sc">+</span> <span class="co"># création de l'objet ggplot, en spécifiant ce qu'on veut en x</span></span>
<span id="cb5-2"><a href=""></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="co"># ajout d'une couche HISTOGRAMME +</span></span>
<span id="cb5-3"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"un joli titre"</span>, <span class="at">x=</span>  <span class="st">"un joli titre pour l'axe x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="ggplot---exemple-distribution-dune-variable-quantitative-3" class="slide level2" data-transition="none">
<h2>GGplot - Exemple: distribution d’une variable quantitative</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> maxO3)) <span class="sc">+</span> <span class="co"># création de l'objet ggplot, en spécifiant ce qu'on veut en x</span></span>
<span id="cb6-2"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span><span class="dv">20</span>) <span class="sc">+</span> <span class="co"># ajout d'une couche HISTOGRAMME, classes plus grossières</span></span>
<span id="cb6-3"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"un joli titre"</span>, <span class="at">x=</span>  <span class="st">"un joli titre pour l'axe x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="ggplot---exemple-distribution-dune-variable-quantitative-4" class="slide level2" data-transition="none">
<h2>GGplot - Exemple: distribution d’une variable quantitative</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">y =</span> maxO3)) <span class="sc">+</span> <span class="co"># création de l'objet ggplot, en spécifiant ce qu'on veut en y</span></span>
<span id="cb7-2"><a href=""></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="co"># ajout d'une couche boxplot</span></span>
<span id="cb7-3"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot du maximum d'ozone"</span>, <span class="at">x=</span>  <span class="st">"un joli titre pour l'axe x"</span>, <span class="at">y =</span> <span class="st">"Maximum d'ozone"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="ggplot---exemple-distribution-dune-variable-quantitative-5" class="slide level2" data-transition="none">
<h2>GGplot - Exemple: distribution d’une variable quantitative</h2>
<p>Moche ? Pensez à <code>theme_bw()</code> (black &amp; white)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">y =</span> maxO3)) <span class="sc">+</span> <span class="co"># création de l'objet ggplot, en spécifiant ce qu'on veut en y</span></span>
<span id="cb8-2"><a href=""></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="co"># ajout d'une couche boxplot, classes plus grossières</span></span>
<span id="cb8-3"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot du maximum d'ozone"</span>, <span class="at">y =</span> <span class="st">"Maximum d'ozone"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="distribution-dune-variable-qualitative-12" class="slide level2 scrollable">
<h2>Distribution d’une variable qualitative (1/2)</h2>
<div style="font-size: 100%;">
<p>Le camembert c’est bon, mais <em>seulement en fromage</em>. SINON CA PUE TROP.</p>
</div>
<div class="fragment">
<div style="font-size: 100%;">
<p>Quelle classe est la plus représentée ?</p>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/pie_bad_idea.png" class="quarto-figure quarto-figure-center" style="width:100.0%" height="240"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/barplot_good_idea.png" class="fragment quarto-figure quarto-figure-center" style="width:100.0%" height="240"></p>
</figure>
</div>
</div>
</section>
<section id="distribution-dune-variable-qualitative-22" class="slide level2 scrollable">
<h2>Distribution d’une variable qualitative (2/2)</h2>
<p><em>Alternative: graphiques en barre</em></p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> vent)) <span class="sc">+</span> <span class="co"># création de l'objet ggplot, en spécifiant ce qu'on veut en x</span></span>
<span id="cb9-2"><a href=""></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="co"># ajout d'une couche barplot</span></span>
<span id="cb9-3"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb9-4"><a href=""></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Nb de jours"</span>, <span class="at">title =</span> <span class="st">"Nombre de jours par direction de vent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" width="336"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-2"><a href=""></a></span>
<span id="cb10-3"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">prop_vent =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(ozone), <span class="at">.by =</span> vent) <span class="sc">%&gt;%</span> <span class="co"># On résume le jeu de donnée par direction de vent, on calcule le nb de chaque catégorie sur la longueur totale du jeu de données</span></span>
<span id="cb10-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">vent =</span> <span class="fu">reorder</span>(vent, prop_vent)) <span class="sc">%&gt;%</span> <span class="co"># trier le facteur pour ordonner les catégories </span></span>
<span id="cb10-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vent, <span class="at">y=</span> prop_vent)) <span class="sc">+</span></span>
<span id="cb10-7"><a href=""></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"%"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href=""></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)<span class="sc">+</span> <span class="co"># 50% de transparence</span></span>
<span id="cb10-9"><a href=""></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb10-10"><a href=""></a><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>scales<span class="sc">::</span><span class="fu">percent</span>(prop_vent)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb10-11"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="336"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="effet-dune-deux-variables-sur-une-variable-quanti" class="slide level2">
<h2>Effet d’une / deux variable(s) sur une variable quanti</h2>
<!-- #| class-source: my_class2 -->
<!-- #| classes: my_class2 -->
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y=</span> maxO3)) <span class="sc">+</span> </span>
<span id="cb11-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># ajout points</span></span>
<span id="cb11-3"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># Ajout ajustement linéaire</span></span>
<span id="cb11-4"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-14-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<!-- #| class-source: my_class2 -->
<!-- #| classes: my_class2 -->
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="co">#| </span></span>
<span id="cb12-2"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y=</span> maxO3, <span class="at">color =</span> vent)) <span class="sc">+</span> <span class="co"># ajout d'une couleur</span></span>
<span id="cb12-3"><a href=""></a>  <span class="co">#par direction du vent</span></span>
<span id="cb12-4"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># ajout points</span></span>
<span id="cb12-5"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># Ajout ajustement linéaire</span></span>
<span id="cb12-6"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-15-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="effet-dune-deux-variables-quali-sur-une-variable-quanti-12" class="slide level2 scrollable">
<h2>Effet d’une / deux variable(s) quali sur une variable quanti (1/2)</h2>
<div class="fragment">
<!-- #| class-source: my_class2 -->
<!-- #| classes: my_class2 -->
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">ggplot</span>(ozone, <span class="fu">aes</span>(<span class="at">x =</span> vent,</span>
<span id="cb13-2"><a href=""></a>                  <span class="at">y=</span> maxO3,</span>
<span id="cb13-3"><a href=""></a>                  <span class="at">fill=</span>vent,</span>
<span id="cb13-4"><a href=""></a>                  <span class="at">col=</span>vent)) <span class="sc">+</span> <span class="co"># dans aes: ce qui DEPEND du jeu de données</span></span>
<span id="cb13-5"><a href=""></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>,<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span> <span class="co"># alpha : transparence</span></span>
<span id="cb13-6"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height=</span> <span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># ajout </span></span>
<span id="cb13-7"><a href=""></a>  <span class="co"># points, avec perturbation horizontale pour faciliter visu</span></span>
<span id="cb13-8"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-9"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span><span class="st">"Effet du vent sur le max d'ozone"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-16-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="effet-de-deux-variables-quali-sur-une-variable-quanti-22" class="slide level2">
<h2>Effet de deux variable(s) quali sur une variable quanti (2/2)</h2>
<div style="font-size: 100%;">
<p>Quid d’une interaction potentielle vent pluie ?</p>
</div>
<div class="fragment">
<div style="font-size: 100%;">
<p><em>Point code</em> : La fonction <code>%&gt;%</code> de <code>dplyr</code> permet de passer des arguments en chaîne dans des fonctions. Par ex.:</p>
<div class="cell my_class_code">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb14-2"><a href=""></a><span class="fu">max</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">library</span>(dplyr) <span class="co"># permet d'utiliser %&gt;% </span></span>
<span id="cb16-2"><a href=""></a>x <span class="sc">%&gt;%</span> max <span class="co"># equivaut à max(x)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell my_class_code columns column-output-location">
<div class="column">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-2"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">moy_O3 =</span> <span class="fu">mean</span>(maxO3), <span class="at">.by =</span>  <span class="fu">c</span>(vent, pluie)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href=""></a>  <span class="co"># MOYENNER LES VALEURS DE MAXO3 PAR VENT ET PLUIE </span></span>
<span id="cb18-5"><a href=""></a>  <span class="co">#ET PASSER LE RESULTAT DANS GGPLOT VIA %&gt;% </span></span>
<span id="cb18-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vent, <span class="at">y=</span> moy_O3, <span class="at">group =</span> pluie, <span class="at">color =</span>pluie)) <span class="sc">+</span></span>
<span id="cb18-7"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb18-8"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-9"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span><span class="st">"Interaction pluie:vent sur le max03"</span>,</span>
<span id="cb18-11"><a href=""></a>       <span class="at">y =</span> <span class="st">"Moyenne de maxO3"</span>, <span class="at">x =</span> <span class="st">"Direction du vent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-18-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="des-visualisations-vers-les-tests-statistiques" class="slide level2">
<h2>Des visualisations vers les tests statistiques</h2>
<p>Les visus précédentes nous ont permis d’intuiter certaines tendances.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-19-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-20-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Peut-on les généraliser ? Rappel:</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/plot_population_and_sample_inference.png" class="fragment quarto-figure quarto-figure-center" style="width:60.0%" height="280"></p>
</figure>
</div>
</div>
<div class="fragment">
<p>C’est toute la question des <em>tests statistiques</em>.</p>
</div>
</section></section>
<section>
<section id="principes-et-applications-des-tests-statistiques" class="title-slide slide level1 center">
<h1>Principes et applications des tests statistiques</h1>

</section>
<section id="de-la-question-aux-tests" class="slide level2">
<h2>De la question aux tests</h2>
<ul>
<li>On dispose de multiples variables, toutes présentant potentiellement un intérêt</li>
</ul>
<div class="cell my_class_code">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="fu">colnames</span>(ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "maxO3"  "T9"     "T12"    "T15"    "Ne9"    "Ne12"   "Ne15"   "Vx9"   
 [9] "Vx12"   "Vx15"   "maxO3v" "vent"   "pluie" </code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Ici une variable particulière nous intéresse (c’est un <em>choix</em> ; guidé par la littérature scientifique / les politiques publiques etc. ): maxO3 (car étant clé pour la pollution de l’air). C’est la <strong>variable réponse</strong></li>
</ul>
</div>
<div class="fragment">
<p>On peut se poser plusieurs questions:</p>
<ul>
<li>Effet du vent sur le max d’ozone ?</li>
<li>Le temps sec/pluvieux influence-t-il le max d’ozone ? De la même manière selon les différentes directions du vent ?</li>
</ul>
<p><strong>Objectif</strong> : <span style="color:blue;">Généraliser (inférer) au-delà des données de l’échantillon</span></p>
<p><strong>Problème</strong> : <span style="color:red;">Comment gérer l’incertitude liée au fait qu’on a observé qu’une petite partie des données</span></p>
</div>
</section>
<section id="rappel-sur-la-notion-de-distribution-statistique" class="slide level2">
<h2>Rappel sur la notion de distribution statistique</h2>
<ul>
<li><p><strong>Définition :</strong><br>
Une distribution statistique décrit comment les valeurs d’une variable se répartissent dans un ensemble de données.</p></li>
<li><p><strong>Types de variables :</strong></p>
<ul>
<li><em>Quantitatives</em> : mesurables (ex : taille des plantes).</li>
<li><em>Qualitatives</em> : catégories (ex : variétés de cultures).</li>
</ul></li>
</ul>
<div class="fragment">
<p><strong>Quelques paramètres descriptifs d’une distribution</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><strong>Tendance centrale :</strong>
<ul>
<li>Moyenne : la “valeur attendue”.</li>
<li>Médiane : la valeur au milieu de la distribution.</li>
<li>Mode : la valeur la plus fréquente.</li>
</ul></li>
<li><strong>Dispersion :</strong>
<ul>
<li>Variance / écarte-type</li>
<li>IQR / étendue</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-22-1.png" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interprétation-probabiliste" class="slide level2">
<h2>Interprétation probabiliste</h2>
<ul>
<li><strong>Probabilité et distributions :</strong>
<ul>
<li>La probabilité qu’une variable aléatoire appartienne à un intervalle donné est proportionnelle à la surface sous la courbe de distribution pour cet intervalle.</li>
</ul></li>
</ul>
<div class="fragment">
<p>En termes mathématiques:</p>
<p><span class="math inline">\(X\)</span> variable aléatoire continue ayant pour densité <span class="math inline">\(f\)</span>.</p>
<p>On a <span class="math inline">\(\mathbb{P}(a \leq X \leq b) = \int_a^b f(t)dt\)</span>.</p>
</div>
<div class="fragment">
<p><strong>Loi normale et règle des 68-95-99</strong></p>
<ul>
<li><strong>Loi normale</strong> : Distribution en forme de cloche centrée autour de la moyenne.</li>
<li><strong>Règle 68-95-99</strong> :
<ul>
<li>68% des données se trouvent à ±1 écart-type de la moyenne.</li>
<li>95% à ±2 écarts-types.</li>
<li>99.7% à ±3 écarts-types.</li>
</ul></li>
</ul>
</div>
</section>
<section class="slide level2">

<p><strong>Illustration de la règle 68-95-99</strong></p>

<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="rappel-théorème-central-limite" class="slide level2">
<h2>Rappel: Théorème central limite</h2>
<div class="fragment">
<p>La moyenne <span class="math inline">\(\bar X\)</span> de <span class="math inline">\(n\)</span> valeurs issues d’une variable <span class="math inline">\(X\)</span> de loi quelconque, de moyenne <span class="math inline">\(\mu\)</span> et de variance <span class="math inline">\(\sigma^2\)</span>, suit la loi (si <span class="math inline">\(n &gt; 30\)</span> ou <span class="math inline">\(X \sim \mathcal{N}\)</span>)</p>
<p><span class="math display">\[\bar X \sim {\cal N} (\mu, \sigma^2/n) \quad   \mbox{et donc} \quad \frac{\bar X - \mu}{\sqrt{\sigma^2/n}} \sim {\cal N} (0, 1)\]</span></p>
</div>
<div class="fragment">
<div style="font-size: 85%;">
<ul>
<li>En pratique, <span class="math inline">\(\sigma^2\)</span> rarement connu, et donc doit être estimé à partir de l’échantillon</li>
</ul>
</div>
</div>
<div class="fragment">
<div style="font-size: 85%;">
<ul>
<li><span class="math inline">\(\Longrightarrow\)</span> augmente un peu l’incertitude <span class="math inline">\(\Longrightarrow\)</span> utilisation d’une loi de Student <span class="math inline">\((n-1)\)</span> degrés de liberté (plutôt qu’une loi normale) : <span class="math inline">\(\frac{\bar X - \mu}{\sqrt{S^2/n}} \sim \mathcal{T}(n-1)\)</span></li>
</ul>
</div>
</div>
<div class="fragment">
<div style="font-size: 85%;">
<p>D’où l’intervalle de confiance de <span class="math inline">\(\mu\)</span> au niveau de confiance 95%:</p>
<p><span class="math inline">\(\left[~\bar x - \frac{s}{\sqrt{n}}t_{1-\alpha/2}(n-1)~;~ \bar x + \frac{s}{\sqrt{n}}t_{1-\alpha/2}(n-1)~\right]\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">t.test</span>(ozone<span class="sc">$</span>maxO3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  ozone$maxO3
t = 33.905, df = 111, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 85.02578 95.58136
sample estimates:
mean of x 
 90.30357 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>x <span class="ot">&lt;-</span> ozone<span class="sc">$</span>maxO3</span>
<span id="cb23-2"><a href=""></a></span>
<span id="cb23-3"><a href=""></a><span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df =</span> <span class="dv">111</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85.02578</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df =</span> <span class="dv">111</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 95.58136</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="le-tcl-cest-puissant" class="slide level2 scrollable">
<h2>Le TCL, c’est PUISSANT</h2>
<div style="font-size: 80%;">
<ul>
<li>Ce que dit le TCL, c’est que peu importe la distribution de base, les moyennes empiriques d’échantillons issues cette distribution auront une distribution normale centrée sur l’espérance de la distribution !</li>
</ul>
</div>
<div class="fragment">
<div style="font-size: 80%;">
<p><strong>Une simulation rapide pour visualiser les choses</strong></p>
<ul>
<li>Ex distribution <span class="math inline">\(\chi_2(3)\)</span></li>
<li>On connaît la vraie moyenne de cette loi: 3</li>
</ul>
</div>
</div>
<div class="fragment">
<div style="font-size: 80%;">
<p>Mais dans la <em>vraie vie</em>, on aurait accès qu’à un échantillon de cette loi, par ex. de taille <span class="math inline">\(n = 50\)</span>. Regardons comment évolue la distribution des moyennes empiriques en fonction de la taille de l’échantillon.</p>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-26-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="intervalle-de-confiance-vers-test-de-conformité" class="slide level2">
<h2>Intervalle de confiance vers test de conformité</h2>
<ul>
<li>On suppose / connaît <span class="math inline">\(\frac{\bar X - \mu}{\sqrt{S^2/n}} \sim {\mathcal T}(n-1)\)</span>.</li>
</ul>
<div class="fragment">
<ul>
<li>On peut maintenant tester si la moyenne est égale à une valeur particulière, par ex est-ce que <span class="math inline">\(\mu = 100\)</span> ?</li>
</ul>
</div>
<div class="fragment">
<p>A partir d’un échantillon <span class="math inline">\(x\)</span>, on peut calculer <span class="math inline">\(\bar{x}\)</span> et <span class="math inline">\(s^2\)</span> et se demander si la valeur est typique d’une loi de Student à n-1 ddl.</p>
</div>
<div class="fragment">
<p><strong>Quelques définitions</strong></p>
<ul>
<li><span class="math inline">\(H_0\)</span> hypothèse nulle, <span class="math inline">\(H_0: \mu = 100\)</span> vs <span class="math inline">\(H_1\)</span> hypothèse alternative, <span class="math inline">\(H_1: \mu \neq 100\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Statistique de test</strong>: <span class="math inline">\(\frac{\bar X - \mu}{\sqrt{S^2/n}}\)</span>: il s’agit de la valeur qu’on peut calculer à partir de l’échantillon, et qu’on suppose suivre une certaine loi <strong>sous</strong> <span class="math inline">\(H_0\)</span>: ici une loi de Student à <span class="math inline">\(n-1\)</span> ddl</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>p-value</strong> du test: probabilité calculée sous <span class="math inline">\(H_0\)</span>, que la statistique de test soit plus extrême que la valeur observée Tobs</li>
</ul>
<blockquote>
<p>p-value: “Dans un monde où <span class="math inline">\(H_0\)</span> est vraie, la probabilité d’obtenir une valeur au moins aussi extrême pour la statistique de test est de p”</p>
</blockquote>
<p>Si p &lt; 0.05, on rejette l’hypothèse <span class="math inline">\(H_0\)</span> au seuil de 5%</p>
</div>
</section>
<section class="slide level2">

<p>Dans notre cas, n = 112, donc <span class="math inline">\(T\)</span> est censée suivre une loi de Student à 111 ddl, sous <span class="math inline">\(H_0\)</span>:</p>
<!-- . . . -->

<img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"><div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  ozone$maxO3
t = -3.6406, df = 111, p-value = 0.0004148
alternative hypothesis: true mean is not equal to 100
95 percent confidence interval:
 85.02578 95.58136
sample estimates:
mean of x 
 90.30357 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004147533</code></pre>
</div>
</div>
</div><!-- . . . --><div class="column" style="width:50%;">
<p>Pour une loi de Student à n-1 ddl, -3.64 est une valeur <em>peu probable</em> donc on rejette <span class="math inline">\(H_0\)</span>, au seuil de 5%.</p>
</div>
</div>
<div class="fragment">
<blockquote>
<p>Ici, on a testé <span class="math inline">\(H_0\)</span> vs H1 : <span class="math inline">\(\mu \neq 100\)</span> (alternative = “two.sided”) mais on aurait pu testeer H1: <span class="math inline">\(\mu &lt; 100\)</span> (alternative = “less”) ou H1: <span class="math inline">\(\mu &gt; 100\)</span> (alternative = “greater”)</p>
</blockquote>
</div>
</section>
<section id="comparaison-de-2-moyennes-12" class="slide level2">
<h2>Comparaison de 2 moyennes (1/2)</h2>
<p><strong>Question</strong>: le temps (sec/pluvieux) a-t-il un effet sur le max d’ozone ?</p>
<div class="fragment">
<p>Réflexe: visu !</p>
<div class="cell columns column-output-location">
<div class="column">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pluie, <span class="at">y =</span> maxO3, <span class="at">fill =</span> pluie, <span class="at">col =</span> pluie)) <span class="sc">+</span></span>
<span id="cb29-3"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">05</span>, <span class="at">height =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb29-4"><a href=""></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span>  .<span class="dv">3</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb29-5"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-29-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Passer de l’échantillon à n’importe quel jour induit de l’incertitude. Mais, il est plus facile de conclure qu’il y a une différence entre les deux moyennes <em>dans la population</em> si:</p>
<ol type="1">
<li>Les moyennes sont très différentes (<i class="fa-solid fa-smoking fa-1xl" aria-label="smoking"></i> vs <i class="fa-solid fa-ban-smoking fa-1xl" aria-label="ban-smoking"></i>)</li>
<li>La variabilité du maximum d’ozone est faible au sein des jours pluvieux et au sein des jours secs</li>
<li>Il y a beaucoup de données</li>
</ol>
</div>
</section>
<section id="comparaison-de-2-moyennes-22" class="slide level2">
<h2>Comparaison de 2 moyennes (2/2)</h2>
<p>On considère que les données de la sous-population 1 sont telles que <span class="math inline">\((X_{i1})_{1\leq i\leq n_1} \sim {\cal N}(\mu_1,\sigma^2)\)</span> et que les données de la sous-population 2 sont telles que <span class="math inline">\((X_{i2})_{1\leq i\leq n_2} \sim {\cal N}(\mu_2,\sigma^2)\)</span> <span class="math inline">\(\Rightarrow\)</span> (pour l’instant) seules les moyennes peuvent être différentes</p>
<div class="fragment">
<ul>
<li><span class="math inline">\(H_0\)</span> hypothèse nulle, <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> vs <strong>H1 hypothèse alternative</strong>, <span class="math inline">\(H_1: \mu_1 \neq\mu_2\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Statistique de test</strong>: <span class="math inline">\(T = \frac{\bar{X_1} - \bar{X_2}}{\sqrt{\frac{\hat{\sigma}^2}{n_1} + \frac{\hat{\sigma}^2}{n_2}}}\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Sous <span class="math inline">\(H_0\)</span>, T suit une loi de Student <span class="math inline">\(n_1 + n_2 -2\)</span></li>
</ul>
</div>
<div class="fragment">
<blockquote>
<p>Si les variances sont inégales, le test est différent <span class="math inline">\(\Longrightarrow\)</span> tester l’égalité des variances avant de faire le test de comparaison de moyennes</p>
</blockquote>
</div>
</section>
<section id="test-de-comparaison-de-2-variances" class="slide level2">
<h2>Test de comparaison de 2 variances</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span class="math inline">\(H_0\)</span> hypothèse nulle, <span class="math inline">\(H_0:\sigma_1^2=\sigma_2^2\)</span> vs <span class="math inline">\(H_1\)</span> hypothèse alternative, <span class="math inline">\(H1: \sigma_1^2\ne\sigma_2^2\)</span></li>
</ul>
<p><span class="math inline">\(\Longleftrightarrow~~H_0:\frac{\sigma_1^2}{\sigma_2^2}=1\)</span> contre <span class="math inline">\(H_1:\frac{\sigma_1^2}{\sigma_2^2}\ne 1\)</span></p>
<div class="fragment">
<ul>
<li>Statistique de test: <span class="math inline">\(F=\frac{S_1^2}{S_2^2}\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Sous <span class="math inline">\(H_0\)</span>, F suit une loi de Fisher à <span class="math inline">\(n_1 - 1\)</span> et <span class="math inline">\(n_2 - 1\)</span> ddl</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-30-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mise-en-pratique" class="slide level2">
<h2>Mise en pratique</h2>
<div class="cell my_class_code">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="fu">var.test</span>(maxO3 <span class="sc">~</span>pluie, <span class="at">data =</span> ozone, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  maxO3 by pluie
F = 0.35906, num df = 42, denom df = 68, p-value = 0.0005659
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.2108847 0.6338374
sample estimates:
ratio of variances 
         0.3590605 </code></pre>
</div>
</div>
<div class="fragment">
<blockquote>
<p>Ici on rejet <span class="math inline">\(H_0\)</span> au seuil de 5%, les variances sont différentes</p>
</blockquote>
<div class="cell my_class_code">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a><span class="co"># NOTEZ LE VAR.EQUAL</span></span>
<span id="cb32-2"><a href=""></a><span class="fu">t.test</span>(maxO3 <span class="sc">~</span>pluie, <span class="at">data =</span> ozone, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  maxO3 by pluie
t = -6.3362, df = 109.88, p-value = 5.321e-09
alternative hypothesis: true difference in means between group Pluie and group Sec is not equal to 0
95 percent confidence interval:
 -36.02936 -18.86110
sample estimates:
mean in group Pluie   mean in group Sec 
           73.39535           100.84058 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r my_class_code number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">t.test</span>(maxO3 <span class="sc">~</span>pluie, <span class="at">data =</span> ozone, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  maxO3 by pluie
t = -5.6715, df = 110, p-value = 1.157e-07
alternative hypothesis: true difference in means between group Pluie and group Sec is not equal to 0
95 percent confidence interval:
 -37.03521 -17.85525
sample estimates:
mean in group Pluie   mean in group Sec 
           73.39535           100.84058 </code></pre>
</div>
</div>
<blockquote>
<p>On rejette <span class="math inline">\(H_0\)</span>, on affirme que les moyennes sont significativement différentes</p>
</blockquote>
</div>
</section>
<section id="erreur-et-puissance-dun-test" class="slide level2">
<h2>Erreur et puissance d’un test</h2>
<div class="fragment">
<p>Décision d’un test prise pour la population (“il y a plus d’ozone les jours sec”) alors qu’on n’observe qu’un échantillon</p>
<p><span class="math inline">\(\Rightarrow\)</span> Décision incertaine, et deux erreur possibles</p>
<ul>
<li><strong>Erreur de première espèce</strong>: rejeter <span class="math inline">\(H_0\)</span> alors que celle-ci est vraie: faux positif</li>
<li><strong>Erreur de deuxième espèce</strong> : ne pas rejeter <span class="math inline">\(H_0\)</span> alors que celle-ci est fausse: faux négatif</li>
</ul>
<p>En image (<i class="fa-solid fa-question fa-1xl" aria-label="question"></i> <strong>qu’est-ce que H0 ici ?</strong>):</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/type_1_2_error.png" class="quarto-figure quarto-figure-center" style="width:80.0%" height="250"></p>
</figure>
</div>
</div>
<div class="fragment">
<blockquote>
<p>un test est dit puissant si son erreur de 2ème espèce est petite. La <strong>puissance d’un test</strong> est la probabilité de rejeter <span class="math inline">\(H_0\)</span> et d’avoir raison</p>
</blockquote>
</div>
</section>
<section id="puissance-dun-test-12" class="slide level2">
<h2>Puissance d’un test (1/2)</h2>
<p><strong>Question souvent posée</strong> Combien de données faut-il pour tester une différence entre 2 moyennes ?</p>
<p>Par ex.: combien de patients pour tester s’il y a une diff entre 2 médicaments pour faire baisser le taux de cholestérol ?</p>
<div class="fragment">
<p>Rappel: de quoi est-ce que ça dépend ?</p>
<ul>
<li><p><i class="fa-solid fa-question fa-1xl" aria-label="question"></i></p></li>
<li><p><i class="fa-solid fa-question fa-1xl" aria-label="question"></i></p></li>
<li><p><i class="fa-solid fa-question fa-1xl" aria-label="question"></i></p></li>
</ul>
</div>
<div class="fragment">
<p><strong>Reformuler la question</strong></p>
<p>Combien faut-il de patients pour mettre en évidence une différence d’au moins 0.2g/l entre les 2 médicaments ?</p>
</div>
<div class="fragment">
<p>Toujours pas possible <i class="fa-solid fa-face-frown fa-1xl" aria-label="face-frown"></i></p>
</div>
<div class="fragment">
<p>MAAAAAIS <i class="fa-solid fa-face-smile fa-1xl" aria-label="face-smile"></i></p>
</div>
</section>
<section id="puissance-dun-test-22" class="slide level2">
<h2>Puissance d’un test (2/2)</h2>
<p><strong>MAAAAAIS</strong> <i class="fa-solid fa-face-smile fa-1xl" aria-label="face-smile"></i> si;</p>
<ul>
<li>on connaît la variance de la variable d’intérêt (ex. expériences antérieures montrent un écart-type de 0.4g/l) (<code>sd</code>)</li>
<li>on veut détecter une différence donnée par ex toute diff &gt; 0.2g/l (<code>delta</code>)</li>
<li>on veut détecter cette différence avec proba de 80% (<code>power</code>)</li>
</ul>
<p><strong>alors c’est possible</strong> <i class="fa-solid fa-face-smile-wink fa-1xl" aria-label="face-smile-wink"></i></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">power.t.test</span>(<span class="at">delta=</span>  <span class="fl">0.2</span>, <span class="at">sd =</span> <span class="fl">0.4</span>, <span class="at">power =</span> .<span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 63.76576
          delta = 0.2
             sd = 0.4
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="analyse-de-variance-à-un-facteur" class="title-slide slide level1 center">
<h1>Analyse de variance à un facteur</h1>

</section>
<section id="test-de-leffet-dun-facteur" class="slide level2">
<h2>Test de l’effet d’un facteur</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>Par ex. <em>la direction du vent a-t-elle un effet sur le maximum d’ozone</em> ?</p>
<p><strong>Variable réponse quantitative</strong>, notée Y: maxO3</p>
<p><strong>Variable explicative qualitative à I modalités (groupes)</strong>: direction du vent</p>
<p>C’est le cadre de l’ANOVA (<strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance)</p>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> maxO3   T9  T12  T15 Ne9 Ne12 Ne15     Vx9    Vx12    Vx15 maxO3v  vent pluie
    87 15.6 18.5 18.4   4    4    8  0.6946 -1.7101 -0.6946     84  Nord   Sec
    82 17.0 18.4 17.7   5    5    7 -4.3301 -4.0000 -3.0000     87  Nord   Sec
    92 15.3 17.6 19.5   2    5    4  2.9544  1.8794  0.5209     82   Est   Sec
   114 16.2 19.7 22.5   1    1    0  0.9848  0.3473 -0.1736     92  Nord   Sec
    94 17.4 20.5 20.4   8    8    7 -0.5000 -2.9544 -4.3301    114 Ouest   Sec
    80 17.7 19.8 18.3   6    6    7 -5.6382 -5.0000 -6.0000     94 Ouest Pluie</code></pre>
</div>
</div>
</div>
</div>
<p>Réflexe … <i class="fa-solid fa-question fa-1xl" aria-label="question"></i> <i class="fa-solid fa-question fa-1xl" aria-label="question"></i> <i class="fa-solid fa-question fa-1xl" aria-label="question"></i></p>
<div class="fragment">
<p>Visu!</p>
<div class="cell columns column-output-location">
<div class="column">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vent, <span class="at">y =</span> maxO3, <span class="at">fill =</span> vent, <span class="at">col =</span> vent)) <span class="sc">+</span></span>
<span id="cb39-3"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">05</span>, <span class="at">height =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb39-4"><a href=""></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span>  .<span class="dv">3</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb39-5"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb39-6"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effet du vent sur le max d'ozone"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-35-1.png" width="528"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Question de base modifiée en : la moyenne du maximum d’ozone est-elle la même pour chaque direction du vent ?</strong></p>
</div>
</section>
<section id="problématique-qui-revient-souvent" class="slide level2">
<h2>Problématique qui revient souvent</h2>
<ul>
<li>L’effet de cultures intermédiaires est-il le même selon l’espèce/variété ?</li>
</ul>
<div class="fragment">
<ul>
<li>La présence de haies a-t-elle une influence sur la population d’auxiliaires de cultures ?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Y a-t-il un effet de la variété sur le rendement du blé dans telle expérimentation ?</p></li>
<li><p>etc. etc. etc.</p></li>
</ul>
</div>
<div class="fragment">
<p>De manière générale, l’ANOVA est le cadre d’analyse de <strong>l’effet d’une variable qualitative</strong> à <em>I</em> modalités (par ex. sol nu / moutarde / phacélie) sur une <strong>variable quantitative</strong></p>
</div>
<div class="fragment">
<p>Mais alors pourquoi parler d’Analyse de Variance si on veut comparer des moyennes ?</p>
</div>
<div class="fragment">
<p>La réponse viendra avec les explications (et les mains dans le cambouis)</p>
</div>
</section>
<section id="mettons-les-mains-dans-le-cambouis" class="slide level2">
<h2>Mettons les mains dans le cambouis</h2>
<p><strong>Données &amp; notations</strong></p>
<div class="center">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">vent</th>
<th style="text-align: center;">maxO3</th>
<th style="text-align: center;">Notation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Est</td>
<td style="text-align: center;">92</td>
<td style="text-align: center;"><span class="math inline">\(y_{11}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Est</td>
<td style="text-align: center;">121</td>
<td style="text-align: center;"><span class="math inline">\(y_{12}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nord</td>
<td style="text-align: center;">87</td>
<td style="text-align: center;"><span class="math inline">\(y_{21}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Nord</td>
<td style="text-align: center;">82</td>
<td style="text-align: center;"><span class="math inline">\(y_{22}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ouest</td>
<td style="text-align: center;">94</td>
<td style="text-align: center;"><span class="math inline">\(y_{31}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ouest</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;"><span class="math inline">\(y_{32}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sud</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;"><span class="math inline">\(y_{41}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
</tbody>
</table>
</div>
<p><span class="math inline">\(y_{ij}\)</span> valeur de <span class="math inline">\(Y\)</span> pour l’individu <span class="math inline">\(j\)</span> du groupe <span class="math inline">\(i\)</span></p>
<div class="fragment">
<p>Moyenne du groupe <span class="math inline">\(i\)</span>: <span class="math inline">\(y_{i\bullet}=\frac{1}{n_i}\sum_{j=1}^{n_i} y_{ij}\)</span></p>
<p>Moyenne générale : <span class="math inline">\(y_{\bullet\bullet}=\frac{1}{n}\sum_{i=1}^I\sum_{j=1}^{n_i} y_{ij}\)</span></p>
</div>
</section>
<section id="comparaison-de-i-moyennes" class="slide level2">
<h2>Comparaison de I moyennes</h2>
<ul>
<li>Dans chaque groupe, on considère que les données suivent une loi <span class="math inline">\(\mathcal{N}(\mu_i, \sigma^2)\)</span></li>
</ul>
<p>On considère le <strong>MEME</strong> <span class="math inline">\(\sigma^2\)</span>.</p>
<div class="fragment">
<div class="center">
<p><span class="math inline">\(Y_{1j} \sim {\cal N}(\mu_1,\sigma^2)\)</span> peut s’érire <span class="math inline">\(Y_{1j} = \mu_1 + \varepsilon_{1j}\mbox{ avec }\varepsilon_{1j}\sim {\cal N}(0,\sigma^2)\)</span><br>
<span class="math inline">\(Y_{2j} \sim {\cal N}(\mu_2,\sigma^2)\)</span> peut s’écrire <span class="math inline">\(Y_{2j} = \mu_2 + \varepsilon_{2j}\mbox{ avec }\varepsilon_{2j}\sim {\cal N}(0,\sigma^2)\)</span><br>
…&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…<br>
<span class="math inline">\(Y_{Ij} \sim {\cal N}(\mu_I,\sigma^2)\)</span> peut s’écrire <span class="math inline">\(Y_{Ij} = \mu_I + \varepsilon_{Ij}\mbox{ avec }\varepsilon_{Ij}\sim {\cal N}(0,\sigma^2)\)</span></p>
</div>
<p><span class="math inline">\(\Rightarrow\)</span> On peut résumer tout ça dans un seul modèle:</p>
</div>
<div class="fragment">
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j~~~~Y_{ij}=\mu_i+ \varepsilon_{ij}\\
\forall i,j~~~~{\cal L}(\varepsilon_{ij})={\cal N}(0,\sigma^2)\\
\forall (i,j)\neq (i',j')~~cov(\varepsilon_{ij},\varepsilon_{i'j'})=0\\
\end{array}\right.\]</span></p>
</div>
</section>
<section id="deux-définitions-du-modèle" class="slide level2">
<h2>Deux définitions du modèle</h2>
<p>Si <span class="math inline">\(Y_{ij}\)</span> est la valeur de la réponse du j<span class="math inline">\(^{eme}\)</span> individu (<span class="math inline">\(j = 1, . . . , n_i\)</span>) du i<span class="math inline">\(^{eme}\)</span> groupe (<span class="math inline">\(i = 1, . . . , I\)</span>):</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/modele_aov_mu.png" class="quarto-figure quarto-figure-center" style="width:100.0%" height="250"></p>
</figure>
</div>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j~~~~Y_{ij}=\mu_i+ \varepsilon_{ij}\\
\forall i,j~~~~{\cal L}(\varepsilon_{ij})={\cal N}(0,\sigma^2)\\
\forall (i,j)\neq (i',j')~~cov(\varepsilon_{ij},\varepsilon_{i'j'})=0\\
\end{array}\right.\]</span></p>
<p><span class="math inline">\(I\)</span> paramètres: les <span class="math inline">\(\mu_i\)</span></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/modele_aov_alpha.png" class="quarto-figure quarto-figure-center" style="width:100.0%" height="250"></p>
</figure>
</div>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j~~~~Y_{ij}=\mu+\alpha_i+ \varepsilon_{ij}\\
\forall i,j~~~~{\cal L}(\varepsilon_{ij})={\cal N}(0,\sigma^2)\\
\forall (i,j)\neq (i',j')~~cov(\varepsilon_{ij},\varepsilon_{i'j'})=0\\
\end{array}\right.\]</span></p>
<p><span class="math inline">\(I + 1\)</span> paramètres: l’effet moyen <span class="math inline">\(\mu\)</span> et les <span class="math inline">\(I\)</span> coefficients <span class="math inline">\(\alpha_i\)</span> (effet du niveau i)</p>
</div>
</div>
<p>On doit avoir <span class="math inline">\(\forall~i,~~\mu+\alpha_i=\mu_i\)</span> besoin de <strong>contraintes</strong></p>
</section>
<section id="estimer-les-paramètres-du-modèle" class="slide level2">
<h2>Estimer les paramètres du modèle</h2>
<p>On minimise les écarts entre observations (<span class="math inline">\(Y_{ij}\)</span>) et prédictions par le modèle <span class="math inline">\(\hat{Y}_{ij}\)</span>.</p>
<p>On minimise le <strong>critère des moindres carrés ordinaires</strong> (<i class="fa-solid fa-question fa-1xl" aria-label="question"></i>: pourquoi carré <span class="math inline">\(^2\)</span>)</p>
<div class="fragment">
<p><span class="math display">\[SCER  =  \sum_{i=1}^{I}\sum_{j=1}^{n_i}\left( Y_{ij} - \hat Y_{ij} \right)^{2}=\sum_{i=1}^{I}\sum_{j=1}^{n_i} \left( Y_{ij} - (\hat\mu +\hat\alpha_i) \right)^{2}\]</span></p>
<p><span class="math display">\[\mbox{SCER minimal quand }\forall~i,~\hat\mu +\hat\alpha_i=\frac{1}{n_i}\sum_{j=1}^{n_i}Y_{ij}=Y_{i\bullet}\]</span></p>
</div>
<div class="fragment">
<p>Contraintes classiques:</p>
<ul>
<li><p>Un niveau particulier comme référence: <span class="math inline">\(\alpha_1 = 0 \ \Rightarrow \hat\mu=Y_{1\bullet}\)</span> et <span class="math inline">\(\forall i, \hat{\alpha}_i=Y_{i\bullet}-Y_{1\bullet}\)</span></p></li>
<li><p>la moyenne des moyennes par groupe comme référence: <span class="math inline">\(\sum_{i=1}^I\alpha_i=0 \ \Rightarrow \hat\mu=\frac{1}{I}\sum_{i=1}^I Y_{i\bullet},  ~~ \forall \,i,\,\hat\alpha_i=Y_{i\bullet}-\hat\mu\)</span></p></li>
</ul>
</div>
</section>
<section id="exemple-pour-clarifier" class="slide level2">
<h2>Exemple pour clarifier</h2>
<div class="center">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">groupe 1</th>
<th style="text-align: center;">groupe 2</th>
<th style="text-align: center;">groupe3</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(y_{11}=6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{21}=2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{31}=3\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(y_{12}=9\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{22}=4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{32}=1\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(y_{13}=6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{22}=3\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(y_{1\bullet}=7\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{2\bullet}=3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{3\bullet}=2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{\bullet\bullet}=4.25\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<ul>
<li><p>Avec traitement 1 comme référence : <span class="math inline">\(\hat\mu= 7\)</span>; <span class="math inline">\(\hat\alpha_1=0\)</span>; <span class="math inline">\(\hat\alpha_2=-4\)</span> et <span class="math inline">\(\hat\alpha_3=-5\)</span></p></li>
<li><p><span class="math inline">\(\sum_{i=1}^I \alpha_i=0\)</span> : <span class="math inline">\(\hat\mu= \frac{1}{3}(7+3+2)=4\)</span> ; <span class="math inline">\(\hat\alpha_1=3\)</span> ; <span class="math inline">\(\hat\alpha_2=-1\)</span> et <span class="math inline">\(\hat\alpha_3 = -2\)</span></p></li>
</ul>
</div>
<div class="fragment">
<blockquote>
<p><span style="color:red;">L’interprétation d’un coefficient <span class="math inline">\(\alpha_i\)</span> dépend de la contrainte choisie !</span></p>
</blockquote>
</div>
</section>
<section id="variance-résiduelle" class="slide level2">
<h2>Variance résiduelle</h2>
<p><strong>Valeurs prédites</strong>: <span class="math inline">\(\hat y_{ij} = \hat{\mu} + \hat{\alpha}_i = y_{i\bullet}\)</span></p>
<div class="fragment">
<p><strong>Erreurs d’ajustement ou résidus</strong> : <span class="math inline">\(\hat\varepsilon_{ij}=y_{ij}-\hat y_{ij}=y_{ij}-y_{i\bullet}\)</span></p>
</div>
<div class="fragment">
<p><strong>Estimateur de la variabilité résiduelle</strong> <span class="math inline">\(\sigma^2\)</span>:</p>
<p><span class="math display">\[\hat \sigma^2=\frac{\sum_{ij}(Y_{ij}-Y_{i\bullet})^2}{n-I}=\frac{\sum_{ij}\hat\varepsilon_{ij}^2}{n-I}~~~~~~~~~~\mathbb{E}(\hat\sigma^2)=\sigma^2\]</span></p>
<p><span class="math inline">\(n-I\)</span> degrés de liberté sont associés à la somme des carrés des résidus du modèle.</p>
</div>
</section>
<section id="décomposition-de-la-variabilité" class="slide level2">
<h2>Décomposition de la variabilité</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/decomp_anova.png" class="quarto-figure quarto-figure-center" style="width:50.0%" height="250"></p>
</figure>
</div>
<div class="fragment">
<p><strong>Equation d’analyse de la variance</strong></p>
<table class="caption-top">
<tbody>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\underbrace{\sum_{i,j}(Y_{ij}-Y_{\bullet \bullet})^2}_{SC_T}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(= \displaystyle{\underbrace{\sum_{i,j}(Y_{i\bullet}-Y_{\bullet \bullet})^2}_{SC_F}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(+ \displaystyle{\underbrace{\sum_{i,j}(Y_{ij}-Y_{i\bullet})^2}_{SC_R}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Variabilité</td>
<td style="text-align: center;">totale</td>
<td style="text-align: center;">modèle</td>
<td style="text-align: center;">résiduelle</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ddl</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n-I\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<ul>
<li>Vous pouvez commencez à comprendre d’où vient le nom ANalysis Of <strong>VAriance</strong></li>
</ul>
</div>
</section>
<section id="indicateur-de-liaison-rapport-de-corrélation" class="slide level2">
<h2>Indicateur de liaison : rapport de corrélation</h2>
<div class="fragment">
<p><span class="math inline">\(\eta^2  = \frac{SC_{\mbox{modèle}}}{SC_{\mbox{total}}} = 1-\frac{SC_{\mbox{résiduelle}}}{SC_{\mbox{total}}}\)</span></p>
<blockquote>
<p>Expliqué à mon grand-père (ou presque): la proportion de variabilité du phénomène que mon modèle explique</p>
</blockquote>
</div>
<div class="fragment">
<p>Propriétés:</p>
<ul>
<li><span class="math inline">\(0 \leq \eta^2 \leq 1\)</span> (obvious)</li>
<li><span class="math inline">\(\eta^2 = 0 \Leftrightarrow SC_{\mbox{modèle}}=0\)</span></li>
<li><span class="math inline">\(\eta^2=1 \Leftrightarrow SC_{\mbox{modèle}}=SC_{\mbox{total}}\)</span></li>
</ul>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-37-1.png" width="451"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-38-1.png" width="451"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div style="text-align: center;">
<p>Deux rapports de corrélation différents pour des <span class="math inline">\(Y_{i\bullet}\)</span> identiques.</p>
</div>
</div>
</section>
<section id="inférence-test-global" class="slide level2">
<h2>Inférence: test global</h2>
<p>Rappel de l’objectif: y a-t-il un effet du facteur sur Y ?</p>
<div class="fragment">
<p><span class="math inline">\(\rightarrow\)</span> La variabilité de Y est-elle expliquée par le facteur groupe ? Ou bien peut-on considérer que les données proviennt d’une même loi <span class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span> ?</p>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:20%;">
<p><strong>Hypothèses:</strong></p>
</div><div class="column" style="width:36%;">
<p><span class="math display">\[H_0 :~\forall i,\ \mu_i=\mu\]</span> <span class="math display">\[H_1 :~\exists i\ /\ \mu_i\ne \mu\]</span></p>
</div><div class="column" style="width:8%;">
<p><span class="math inline">\(\Leftrightarrow\)</span></p>
</div><div class="column" style="width:36%;">
<p><span class="math display">\[H_0 :~\forall i,\ \alpha_i=0\]</span> <span class="math display">\[H_1 :~\exists i\ /\ \alpha_i\ne 0\]</span></p>
</div>
</div>
<p><span class="math display">\[\mbox{On a : }\mathbb{E}\left(\frac{SC_{mod}}{I-1}\right)=\sigma^2+\frac{1}{I-1}\displaystyle{\sum_{i=1}^I n_i\alpha_i^2} \ \ \  \mathbb{E}\left(\frac{SC_{R}}{n-I}\right)=\sigma^2\]</span></p>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><strong>Statistique de test</strong> : <span class="math inline">\(F_{obs}=\displaystyle{\frac{SC_{mod}/(I-1)}{SC_{R}/(n-I)}}\)</span></p></li>
<li><p><strong>Loi de</strong> <span class="math inline">\(F_{obs}\)</span> sous <span class="math inline">\(H_0\)</span> : <span class="math inline">\({\mathcal L}(F_{obs})={\mathcal F}_{n-I}^{I-1}\)</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/fisher_anova.png" class="quarto-figure quarto-figure-center" style="width:80.0%" height="250"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="table-danalyse-de-variance-décomposition-de-variabilité-et-test" class="slide level2">
<h2>Table d’analyse de variance: décomposition de variabilité et test</h2>
<ul>
<li>Ce qui est souvent reporté dans le cadre d’une ANOVA</li>
</ul>
<div class="center">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"><strong>Variabilité</strong></th>
<th style="text-align: center;"><strong>Somme Carrés</strong></th>
<th style="text-align: center;"><strong>ddl</strong></th>
<th style="text-align: center;"><strong>Carré moyen</strong></th>
<th style="text-align: center;"><span class="math inline">\(F_{obs}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Facteur</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\sum_in_i(Y_{i\bullet}-Y_{\bullet\bullet})^2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\frac{SC_F}{I-1}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\frac{CM_F}{CM_R}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Résiduelle</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\sum_{i,j}(Y_{ij}-Y_{i\bullet})^2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n-I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\frac{SC_R}{n-I}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Totale</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\sum_{i,j}(Y_{ij}-Y_{\bullet \bullet})^2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb40-2"><a href=""></a><span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>vent, <span class="at">data =</span> ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
LinearModel(formula = maxO3 ~ vent, data = ozone)

Residual standard error: 27.32 on 108 degrees of freedom
Multiple R-squared:  0.08602 
F-statistic: 3.388 on 3 and 108 DF,  p-value: 0.02074 
AIC = 744.8    BIC = 755.7

Ftest
             SS  df      MS F value  Pr(&gt;F)
vent       7586   3 2528.69  3.3881 0.02074
Residuals 80606 108  746.35                

Ttest
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   94.7382     3.0535 31.0265  &lt; 2e-16
vent - Est    10.8618     6.8294  1.5904  0.11466
vent - Nord   -8.6092     4.6219 -1.8627  0.06522
vent - Ouest -10.0382     4.0972 -2.4500  0.01589
vent - Sud     7.7856     5.2052  1.4957  0.13764</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-40-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inférence-test-de-conformité-dun-coefficient-12" class="slide level2">
<h2>Inférence: test de conformité d’un coefficient (1/2)</h2>
<p>Si on rejette l’hypothèse <span class="math inline">\(H_0: \forall i, \alpha_i=0\)</span>, on veut savoir quels <span class="math inline">\(\alpha_i\)</span> sont différents de 0</p>
<p>La valeur de <span class="math inline">\(\hat\alpha_i\)</span> dépend de l’échantillon de données et donc l’estimateur <span class="math inline">\(\hat\alpha_i\)</span> est une variable aléatoire <span class="math display">\[{\cal L}(\hat\alpha_i)={\cal N}\left(\alpha_i,\sigma_{\hat\alpha_i}^2\right)~~\Longleftrightarrow~~{\cal L}\left(\frac{\hat\alpha_i-\alpha_i}{\sigma_{\hat\alpha_i}}\right)={\cal N}(0,1)\]</span></p>
<div class="fragment">
<p><span class="math display">\[{\cal L}\left(\frac{\hat\alpha_i-\alpha_i}{\hat\sigma_{\hat\alpha_i}}\right)={\cal T}_{n-I}\]</span></p>
<p>On peut donc construire le test de nullité d’un coefficient (<span class="math inline">\(\alpha_1\)</span> par exemple):</p>
<p><strong>Hypothèses</strong> : <span class="math inline">\(H_0 : \alpha_1=0\)</span> contre <span class="math inline">\(H_1 : \alpha_1 \ne 0\)</span></p>
<p><strong>Statistique de test</strong> <span class="math inline">\(\displaystyle\frac{\hat\alpha_1}{\hat\sigma_{\hat\alpha_1}}\)</span></p>
<p><strong>Loi de la statistique de test sous</strong> <span class="math inline">\(H_0\)</span> <span class="math inline">\({\cal L}\left(T_{obs}=\frac{\hat\alpha_1}{\hat\sigma_{\hat\alpha_1}}\right)={\cal T}_{\nu=n-I}\)</span></p>
<p><strong>Décision</strong> par la p-value</p>
</div>
<div class="fragment">
<p>Rq : connaissant la loi de <span class="math inline">\(\hat\alpha_1\)</span>, on peut construire un intervalle de confiance: <span class="math display">\[\alpha_1 \in \left[\hat\alpha_1-\hat\sigma_{\hat\alpha_1}\times t_{0.975}(n-I)~;~\hat\alpha_1+\hat\sigma_{\hat\alpha_1}\times t_{0.975}(n-I) \right]\]</span></p>
</div>
</section>
<section id="inférence-test-de-conformité-dun-coefficient-22" class="slide level2">
<h2>Inférence: test de conformité d’un coefficient (2/2)</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)   94.738210   3.053461 31.026504 1.290980e-55
vent - Est    10.861790   6.829425  1.590440 1.146587e-01
vent - Nord   -8.609178   4.621850 -1.862713 6.522029e-02
vent - Ouest -10.038210   4.097207 -2.450013 1.589160e-02
vent - Sud     7.785599   5.205173  1.495743 1.376372e-01</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-output-line-numbers="3">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb43-2"><a href=""></a>res <span class="ot">&lt;-</span> <span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>vent, <span class="at">data =</span> ozone)</span>
<span id="cb43-3"><a href=""></a></span>
<span id="cb43-4"><a href=""></a>res<span class="sc">$</span>Ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb44"><pre class="sourceCode numberSource highlight numberLines number-lines code-with-copy"><code class="sourceCode"><span id="cb44-1"><a href=""></a>               Estimate Std. Error   t value     Pr(&gt;|t|)</span>
<span id="cb44-2"><a href=""></a>(Intercept)   94.738210   3.053461 31.026504 1.290980e-55</span>
<span id="cb44-3"><a href=""></a>vent - Est    10.861790   6.829425  1.590440 1.146587e-01</span>
<span id="cb44-4"><a href=""></a>vent - Nord   -8.609178   4.621850 -1.862713 6.522029e-02</span>
<span id="cb44-5"><a href=""></a>vent - Ouest -10.038210   4.097207 -2.450013 1.589160e-02</span>
<span id="cb44-6"><a href=""></a>vent - Sud     7.785599   5.205173  1.495743 1.376372e-01</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="test-de-comparaison-2-à-2" class="slide level2">
<h2>Test de comparaison 2 à 2</h2>
<p>Autre stratégie : comparer toutes les paires de moyennes</p>
<p>Pb : on effectue beaucoup de tests <span class="math inline">\(\Rightarrow\)</span> risque de multiplier les erreurs en rejetant des hypothèses <span class="math inline">\(H_0\)</span>.</p>
<p><span class="math inline">\(\Rightarrow\)</span> correction des tests: modifier le seuil <span class="math inline">\(\alpha =5\%\)</span> et prendre <span class="math inline">\(\alpha=\frac{5\%}{(\mbox{nb tests)}}\)</span></p>
<p><span class="math inline">\(\Rightarrow\)</span> les tests sont peu puissants</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb45-2"><a href=""></a></span>
<span id="cb45-3"><a href=""></a></span>
<span id="cb45-4"><a href=""></a>res <span class="ot">&lt;-</span> <span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>vent, <span class="at">data =</span> ozone)</span>
<span id="cb45-5"><a href=""></a></span>
<span id="cb45-6"><a href=""></a><span class="fu">meansComp</span>(res, <span class="sc">~</span>vent, <span class="at">adjust =</span><span class="st">"Bonferroni"</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$adjMean
 vent  emmean   SE  df lower.CL upper.CL
 Est    105.6 8.64 108     83.7    127.5
 Nord    86.1 4.91 108     73.7     98.6
 Ouest   84.7 3.86 108     74.9     94.5
 Sud    102.5 5.96 108     87.4    117.7

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 4 estimates 

$groupComp
$groupComp$Letters
Ouest  Nord   Sud   Est 
  "a"   "a"   "a"   "a" 

$groupComp$LetterMatrix
         a
Ouest TRUE
Nord  TRUE
Sud   TRUE
Est   TRUE


attr(,"class")
[1] "meansComp"</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-44-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="analyse-des-résidus-du-modèle" class="slide level2 scrollable">
<h2>Analyse des résidus du modèle</h2>
<div style="font-size: 70%;">
<p><strong>Rappel du modèle:</strong></p>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j~~~~Y_{ij}=\mu_i+ \varepsilon_{ij}\\
\forall i,j~~~~{\cal L}(\varepsilon_{ij})={\cal N}(0,\sigma^2)\\
\forall (i,j)\neq (i',j')~~cov(\varepsilon_{ij},\varepsilon_{i'j'})=0\\
\end{array}\right.\]</span></p>
<ul>
<li><p>On a des hypothèses sur les <em>résidus</em> du modèle</p></li>
<li><p>Les résidus, c’est ce qui n’est pas expliqué par le modèle. Donc pour les estimer, il faut <em>ajuster</em> le modèle</p></li>
</ul>
</div>
<div class="fragment">
<div style="font-size: 80%;">
<p>On peut ensuite vérifier les hypothèses du modèle</p>
</div>
</div>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a>residus <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residus=</span>res<span class="sc">$</span>lmResult<span class="sc">$</span>residuals, <span class="at">vent =</span> ozone<span class="sc">$</span>vent)</span>
<span id="cb47-2"><a href=""></a>residus <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>residus))<span class="sc">+</span></span>
<span id="cb47-4"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb47-5"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-6"><a href=""></a>  <span class="fu">labs</span>(<span class="at">x  =</span><span class="st">"Résidu"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>, <span class="at">title =</span> <span class="st">"histogramme des résidus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-45-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a>residus <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>residus,<span class="at">x=</span>vent,<span class="at">fill=</span>vent))<span class="sc">+</span></span>
<span id="cb48-3"><a href=""></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb48-4"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot des résidus par vent"</span>) <span class="sc">+</span> </span>
<span id="cb48-5"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-46-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="régression-linéaire-simple" class="title-slide slide level1 center">
<h1>Régression linéaire simple</h1>

</section>
<section id="liaison-linéaire" class="slide level2">
<h2>Liaison linéaire</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb49" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y=</span> maxO3)) <span class="sc">+</span> </span>
<span id="cb49-3"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb49-4"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># se= FALSE pour virer les</span></span>
<span id="cb49-5"><a href=""></a>  <span class="co"># intervalles de confiance, method = "lm" ajustement linéaire</span></span>
<span id="cb49-6"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Lien entre température à 9°C et maximum d'ozone"</span>) <span class="sc">+</span> </span>
<span id="cb49-7"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-47-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Questions</strong> <i class="fa-solid fa-question fa-1xl" aria-label="question"></i></p>
<ul>
<li>Influence de la température sur le max d’ozone ?</li>
<li>A quel max d’ozone peut-on s’attendre s’il fait 19.5°C à 9h ?</li>
</ul>
</div>
<div class="fragment">
<p><strong>Objectifs</strong> <i class="fa-solid fa-bullseye fa-1xl" aria-label="bullseye"></i></p>
<ul>
<li><p>Etudier qualitativement et quantitativement la dépendance d’une variable réponse quantitative Y en fonction d’une variable quantitative x</p></li>
<li><p>La variable x permet elle d’expliquer la variabilité de la variable Y?</p></li>
<li><p>Prédire Y à partir de x</p></li>
</ul>
</div>
</section>
<section id="un-autre-indice-de-liaison-le-coefficient-de-corrélation-linéaire" class="slide level2">
<h2>Un autre indice de liaison: le coefficient de corrélation linéaire</h2>
<p><span class="math display">\[r_{xy}=\frac{\sum_{i=1}^n(x_i-\bar x)(y_i-\bar y)}{\sqrt{\sum_{i=1}^n\left(x_i-\bar x\right)^2}\sqrt{\sum_{i=1}^n(y_i-\bar y)^2}}\]</span></p>
<div>
<ul>
<li class="fragment"><span class="math inline">\(-1\leq r_{xy}\leq 1\)</span></li>
<li class="fragment"><span class="math inline">\(r_{xy}=0 \Leftrightarrow\)</span> pas de liaison <em>linéaire</em> entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span></li>
<li class="fragment"><span class="math inline">\(r_{xy}\approx 1 \Leftrightarrow\)</span> relation <em>linéaire</em> croissante entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span></li>
<li class="fragment"><span class="math inline">\(r_{xy}\approx -1 \Leftrightarrow\)</span> relation <em>linéaire</em> décroissante entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a><span class="fu">cor.test</span>(ozone<span class="sc">$</span>maxO3, ozone<span class="sc">$</span>T9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ozone$maxO3 and ozone$T9
t = 10.263, df = 110, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.5904575 0.7832906
sample estimates:
      cor 
0.6993865 </code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(r_{xy}= 0.70 \ \Rightarrow\)</span> corrélation assez forte (et significativement différente de 0, mais on verra ça plus tard)</li>
</ul>
</div>
</section>
<section id="corrélation-causalité-etc.-12" class="slide level2 scrollable">
<h2>Corrélation, causalité etc. (1/2)</h2>
<div style="font-size: 80%;">
<ul>
<li>Une corrélation est un indicateur utile, mais à utiliser avec précaution</li>
</ul>
<blockquote>
<p>“Corrélation n’implique pas causalité”</p>
</blockquote>
</div>
<div class="fragment">
<div style="font-size: 80%;">
<p>Oui, mais… la présence d’une corrélation suppose généralement un lien</p>
</div>
</div>
<div class="fragment">
<div style="font-size: 80%;">
<ul>
<li>Ex. on observe une corrélation entre A et B. Plusieurs cas existent.</li>
</ul>
<div>
<ul>
<li class="fragment"><p>A <span class="math inline">\(\Rightarrow\)</span> B (ex. <i class="fa-solid fa-smoking fa-1xl" aria-label="smoking"></i> <span class="math inline">\(\Rightarrow\)</span> cancer <i class="fa-solid fa-lungs fa-1xl" aria-label="lungs"></i>)</p></li>
<li class="fragment"><p>B <span class="math inline">\(\Rightarrow\)</span> A (idem)</p></li>
<li class="fragment"><p>A <span class="math inline">\(\Rightarrow\)</span> B et <em>ET</em> B <span class="math inline">\(\Rightarrow\)</span> A (ex. <i class="fa-solid fa-temperature-high fa-1xl" aria-label="temperature-high"></i> et <span class="math inline">\(CO_2\)</span> )</p></li>
<li class="fragment"><p>Une variable C a été omise, et influence A et B. (ex. <i class="fa-solid fa-sun fa-1xl" aria-label="sun"></i> (C) <span class="math inline">\(\Rightarrow\)</span> <i class="bi-sunglasses " style="" role="img" aria-hidden="true"></i> (A),<i class="fa-solid fa-sun fa-1xl" aria-label="sun"></i> (C) <span class="math inline">\(\Rightarrow\)</span> <i class="fa-solid fa-ice-cream fa-1xl" aria-label="ice-cream"></i> (B), <i class="fa-solid fa-ice-cream fa-1xl" aria-label="ice-cream"></i> <span class="math inline">\(\Leftrightarrow\)</span> <i class="bi-sunglasses " style="" role="img" aria-hidden="true"></i>)</p></li>
<li class="fragment"><p>Corrélation purement fortuite (site <a href="https://www.tylervigen.com/spurious-correlations" style="color:blue;">spurious correlations</a>)</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="corrélation-causalité-etc.-22" class="slide level2">
<h2>Corrélation, causalité etc. (2/2)</h2>
<div style="font-size: 80%;">
<p>Ex. pour rigoler:</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/spurious_cor.svg" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div><div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/spurious_cor2.svg" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<div style="font-size: 90%;">
<blockquote>
<p>“Corrélation n’implique pas causalité”</p>
</blockquote>
<p>Ok, mais cette affirmation ne doit pas servir à réfuter toute association constatée dans des données.</p>
</div>
</div>
</section>
<section id="quelques-valeurs-de-corrélations" class="slide level2">
<h2>Quelques valeurs de corrélations</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/illu_corr.jpg" class="quarto-figure quarto-figure-center" style="width:80.0%" height="550"></p>
</figure>
</div>
</section>
<section id="remettons-les-mains-dans-le-cambouis" class="slide level2">
<h2>(Re)Mettons les mains dans le cambouis</h2>
<p>Le modèle de régression linéaire simple s’écrit ainsi:</p>
<div class="fragment">
<p><span class="math display">\[Y_{i} = \beta_0 +\beta_1 x_{i}  +\varepsilon_{i},\quad \varepsilon_{i}\overset{ind}{\sim}\mathcal{N}(0, \sigma^2),\]</span> avec</p>
<ul>
<li><span class="math inline">\(x_i\)</span> la valeur de la variable explicative pour l’observation <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(i=1,\ldots,n\)</span> le numéro d’individu, <span class="math inline">\(n\)</span> le nombre total d’individus</li>
<li><span class="math inline">\(\beta_0\)</span> l’ordonnée à l’origine</li>
<li><span class="math inline">\(\beta_1\)</span> la pente de la droite, mesure de l’effet de la variable <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(\sigma^2\)</span> la variance</li>
</ul>
</div>
</section>
<section id="estimation-des-paramètres" class="slide level2">
<h2>Estimation des paramètres</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[SCER = \sum_{i=1}^n (y_i - \hat{y}_i)^2 = \sum_{i=1}^n (y_i - \beta_0 - \beta_1 x_i)^2\]</span></p>
<p><strong>Paramètres d’espérance:</strong></p>
<ul>
<li><span class="math inline">\(\hat{\beta_1} = \frac{\sum_{i=1}^n (x_i-\bar x)(Y_i-\bar{Y})}{\sum_{i=1}^n (x_i - \bar{x})^2}\)</span></li>
<li><span class="math inline">\(\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{x}\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="r-stack">
<p><img data-src="images/MCO1_T9maxO3_page-0001.jpg" class="fragment"></p>
<p><img data-src="images/MCO2_T9maxO3_page-0001.jpg" class="fragment"></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a>res <span class="ot">&lt;-</span> <span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span> T9, <span class="at">data =</span> ozone)</span>
<span id="cb52-2"><a href=""></a>res<span class="sc">$</span>Ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) -25.607608 11.4551179 -2.235473 2.740572e-02
T9            6.312999  0.6151378 10.262740 9.729952e-18</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Variance résiduelle:</strong></p>
<p><span class="math display">\[ \hat{\sigma}^2 = \frac{1}{n-2} \sum_{i=1}^n (Y_i-\hat{Y}_i)^2 ~~~~~~ddl_{\mbox{résiduelle}}=n-2~~~~~~\mathbb{E}(\hat\sigma^2)=\sigma^2 \]</span></p>
</div>
</section>
<section id="test-de-conformité" class="slide level2">
<h2>Test de conformité</h2>
<p><span class="math display">\[{\mathcal L}\left(\hat{\beta}_1\right)  = {\mathcal N}\left( \beta_1,\sigma_{\beta_1}^2\right) \mbox{  avec  } \sigma_{\beta_1}^2= \frac{\sigma^2}{\sum_{i=1}^{n} ( x_{i} - \bar{x} )^{2}} \]</span></p>
<p><span class="math display">\[\Longrightarrow \ {\mathcal L}\left(\frac{\hat\beta_1-\beta_1}{\sigma_{\hat\beta_1}}\right)={\mathcal N}(0,1)
\ \Longrightarrow~~{\mathcal L}\left(\frac{\hat\beta_1-\beta_1}{\hat\sigma_{\hat\beta_1}}\right)={\mathcal T}_{n-2}\]</span></p>
<div class="fragment">
<p>On peut donc construire le test de nullité de <span class="math inline">\(\beta_1\)</span>:</p>
</div>
<div class="fragment">
<p><strong>Hypothèses</strong> :<span class="math inline">\(\ H_0 : \mbox{"} \beta_1=0\mbox{"}\)</span> contre <span class="math inline">\(H_1 : \mbox{"} \beta_1 \ne 0\mbox{"}\)</span></p>
<p><strong>Statistique de test :</strong> <span class="math inline">\(\displaystyle\frac{\hat\beta_1}{\hat\sigma_{\hat\beta_1}}\)</span> <strong>Loi de la statistique de test sous</strong> <span class="math inline">\(H_0\)</span>: <span class="math inline">\({\mathcal L}\left(T_{obs}=\frac{\hat\beta_1}{\hat\sigma_{\hat\beta_1}}\right)={\mathcal T}_{\nu=n-2}\)</span></p>
<p>Rq 1. : comme dans l’ANOVA, connaissant la loi de <span class="math inline">\(\hat\beta_1\)</span>, on peut construire un intervalle de confiance: <span class="math display">\[\beta_1 \in \left[\hat\beta_1-\hat\sigma_{\hat\beta_1}\times t_{0.975}(n-2) \ ; \ \hat\beta_1+\hat\sigma_{\hat\beta_1}\times t_{0.975}(n-2) \right]\]</span></p>
<p>Rq 2. : on peut aussi tester <span class="math inline">\(\beta_0\)</span> mais cela a moins d’importance en pratique</p>
</div>
</section>
<section id="décomposition-de-la-variabilité-1" class="slide level2">
<h2>Décomposition de la variabilité</h2>
<p><span class="math display">\[\begin{array}{ccccc}
   \sum_{i=1}^{n} ( Y_{i} - \bar{Y} )^{2} &amp; = &amp; \sum_{i=1}^{n} ( \hat{Y}_{i} - \bar{Y} )^{2}
   &amp; + &amp; \sum_{i=1}^{n} ( Y_{i} - \hat{Y}_{i} )^{2}  \\
   SCT &amp; = &amp; SCM &amp; + &amp; SCR   \\
   n - 1 &amp; = &amp; 1 &amp; + &amp; n - 2
   \end{array}\]</span></p>
<div class="fragment">
<p><strong>Table d’analyse de la variance</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="center">
<table class="caption-top">
<tbody>
<tr class="odd">
<td style="text-align: center;">Source</td>
<td style="text-align: center;">Somme de</td>
<td style="text-align: center;">Degrés de</td>
<td style="text-align: center;">Carré</td>
<td style="text-align: center;">F</td>
</tr>
<tr class="even">
<td style="text-align: center;">variation</td>
<td style="text-align: center;">carrés</td>
<td style="text-align: center;">liberté</td>
<td style="text-align: center;">moyen</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Modèle</td>
<td style="text-align: center;">SCM</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(\frac{SCM}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{CMM}{CMR}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Erreur</td>
<td style="text-align: center;">SCR</td>
<td style="text-align: center;">n-2</td>
<td style="text-align: center;">&nbsp;<span class="math inline">\(\frac{SCR}{n-2}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;">SCT</td>
<td style="text-align: center;">n-1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a>res <span class="ot">&lt;-</span> <span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>T9, <span class="at">data=</span>  ozone)</span>
<span id="cb54-2"><a href=""></a>res<span class="sc">$</span>Ftest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             SS  df    MS F value    Pr(&gt;F)    
T9        43138   1 43138  105.32 &lt; 2.2e-16 ***
Residuals 45053 110   410                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Comparaison de <span class="math inline">\(SCM\)</span> et <span class="math inline">\(SCT\)</span> par le critère <span class="math inline">\(\displaystyle{R^{2} = \frac{ SCM }{ SCT } }\)</span></p>
</div>
<div class="fragment">
<p><strong>Propriétés :</strong></p>
<ul>
<li><span class="math inline">\(0\leq R^2\leq 1\)</span></li>
<li><span class="math inline">\(R^2 = 0 \Leftrightarrow SC_{\mbox{modéle}}=0\)</span></li>
<li><span class="math inline">\(R^2=1 \Leftrightarrow SC_{\mbox{modèle}}=SC_{\mbox{total}}\)</span></li>
</ul>
<p><strong>Explication claire du concept sur le <a href="https://scienceetonnante.substack.com/p/quest-ce-quune-correlation-forte" style="color:blue;">site</a> de Science Etonnante</strong></p>
</div>
</section>
<section id="test-du-modèle" class="slide level2">
<h2>Test du modèle</h2>
<p><strong>Hypothèses</strong></p>
<ul>
<li><span class="math inline">\(H_0: \beta_1 = 0, \Leftrightarrow\)</span> le modèle n’a pas d’intérêt (x n’explique pas Y)</li>
<li><span class="math inline">\(H_1: \beta_1 \neq 0, \Leftrightarrow\)</span> le modèle a un intérêt (x explique Y)</li>
</ul>
<div class="fragment">
<p><strong>Stat de Fisher</strong></p>
<p><span class="math inline">\(F = \frac{SCM/1}{SCR/(n-2)}\)</span></p>
</div>
<div class="fragment">
<p><strong>Loi de F sous</strong> <span class="math inline">\(H_0: \mathcal{L}(F) = \mathcal{F}^1_{n-2}\)</span></p>
</div>
</section>
<section id="prédiction-et-intervalle-de-confiance" class="slide level2">
<h2>Prédiction et intervalle de confiance</h2>
<p>Pour une valeur de <span class="math inline">\(x_0\)</span> particulière, on peut maintenant prédire <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[\hat{Y}_0  = \hat{\beta}_0 + \hat{\beta}_1 x_0\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Prédiction de la valeur moyenne de Y pour un <span class="math inline">\(x_0\)</span> particulier</p>
<p><span class="math inline">\(\mathbb{E}(\hat{Y}_0|x_0) \sim \mathcal{N}(Y_0, \sigma \sqrt{\frac{1}{n} + \frac{(x_0 - \bar{x})^2}{\sum_{i=1}^n (x_i - \bar{x})^2)}})\)</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y =</span> maxO3)) <span class="sc">+</span></span>
<span id="cb56-3"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"lm"</span>) <span class="sc">+</span><span class="co"># affiche intervalle de confiance par défaut</span></span>
<span id="cb56-5"><a href=""></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb56-6"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Intervalle de confiance du comportement moyen"</span>)<span class="sc">+</span></span>
<span id="cb56-7"><a href=""></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-51-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Différent de:</p>
<p>Prédiction d’une nouvelle valeur de Y pour un <span class="math inline">\(x_0\)</span> donné (<em>notez le 1 supplémentaire dans la variance</em>).</p>
<p><span class="math inline">\(\hat{Y}_0 \sim \mathcal{N}(Y_0, \sigma \sqrt{1+\frac{1}{n} + \frac{(x_0 - \bar{x})^2}{\sum_{i=1}^n (x_i - \bar{x})^2)}})\)</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href=""></a>data_predict <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="fu">data.frame</span>(<span class="at">T9 =</span> ozone<span class="sc">$</span>T9),  <span class="fu">predict</span>(<span class="fu">lm</span>(maxO3 <span class="sc">~</span> T9, <span class="at">data=</span> ozone), <span class="at">interval =</span> <span class="st">"predict"</span>))</span>
<span id="cb57-2"><a href=""></a></span>
<span id="cb57-3"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y =</span> maxO3)) <span class="sc">+</span></span>
<span id="cb57-5"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"lm"</span>) <span class="sc">+</span><span class="co"># affiche intervalle de confiance par défaut</span></span>
<span id="cb57-7"><a href=""></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> data_predict, <span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">ymax =</span> upr, <span class="at">ymin =</span> lwr, <span class="at">y =</span> fit), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"lightblue3"</span>) <span class="sc">+</span> </span>
<span id="cb57-8"><a href=""></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb57-9"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Intervalle de confiance du comportement moyen"</span>) <span class="sc">+</span></span>
<span id="cb57-10"><a href=""></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-52-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="validité-du-modèle" class="slide level2">
<h2>Validité du modèle</h2>
<p><strong>Vérification des hypothèses de départ:</strong></p>
<ul>
<li>Normalité des résidus, stabilité de la variance, indépendance des résidus</li>
</ul>
<p><img data-src="images/aber.jpg" style="width:100.0%" height="400"></p>
</section></section>
<section>
<section id="construction-et-sélection-de-modèle" class="title-slide slide level1 center">
<h1>Construction et sélection de modèle</h1>

</section>
<section id="modéliser-comprendre-et-prévoir" class="slide level2" style="font-size: 140%;">
<h2>Modéliser = Comprendre et prévoir</h2>
<p><i class="fa-solid fa-question fa-1xl" aria-label="question"></i> Des exemples de modélisation que vous effectuez tous les jours ?</p>
<div class="fragment">
<div>
<ul>
<li class="fragment">Budget pour évènement <i class="fa-solid fa-dollar-sign fa-1xl" aria-label="dollar-sign"></i> <i class="fa-solid fa-cake-candles fa-1xl" aria-label="cake-candles"></i></li>
<li class="fragment"><i class="fa-solid fa-sun fa-1xl" aria-label="sun"></i> <i class="fa-solid fa-shirt fa-1xl" aria-label="shirt"></i> vs <i class="fa-solid fa-snowflake fa-1xl" aria-label="snowflake"></i> <i class="fa-solid fa-mug-hot fa-1xl" aria-label="mug-hot"></i></li>
<li class="fragment"><p><i class="fa-solid fa-calendar-days fa-1xl" aria-label="calendar-days"></i></p></li>
</ul>
</div>
</div>
<div class="fragment">
<p><i class="fa-solid fa-question fa-1xl" aria-label="question"></i> Comment faites-vous ?</p>
</div>
<div class="fragment">
<ul>
<li>Ex. estimation du budget d’une soirée d’anniversaire</li>
</ul>
<div>
<ul>
<li class="fragment"><p>Vous listez les variables (<i class="fa-solid fa-people-group fa-1xl" aria-label="people-group"></i> <i class="fa-solid fa-beer-mug-empty fa-1xl" aria-label="beer-mug-empty"></i> <i class="fa-solid fa-wine-bottle fa-1xl" aria-label="wine-bottle"></i> <i class="fa-solid fa-pizza-slice fa-1xl" aria-label="pizza-slice"></i> <i class="fa-solid fa-plug-circle-plus fa-1xl" aria-label="plug-circle-plus"></i> <i class="fa-solid fa-droplet fa-1xl" aria-label="droplet"></i> etc.)</p></li>
<li class="fragment"><p>Vous éliminez celles qui sont négligeables (ex. <i class="fa-solid fa-plug-circle-plus fa-1xl" aria-label="plug-circle-plus"></i> <i class="fa-solid fa-droplet fa-1xl" aria-label="droplet"></i>)</p></li>
<li class="fragment"><p>Vous quantifiez l’effet des variables restantes</p></li>
</ul>
</div>
</div>
<div class="fragment">
<p>Les statistiques permettent de faire cela avec des phénomènes complexes, en partant de données collectées.</p>
</div>
</section>
<section id="exemple-de-problématiques" class="slide level2" style="font-size: 140%;">
<h2>Exemple de problématiques</h2>
<div>
<ul>
<li class="fragment"><p>Prévoir la sévérité d’une maladie fongique en fonction de la météo (P/ETP/T°) et de l’itk (gestion des résidus, sensibilité variétale etc;)</p></li>
<li class="fragment"><p>Prédire les potentiels de rendements futurs du soja en France</p></li>
<li class="fragment"><p>Potentiel de production éolien en fonction des conditions météorologiques</p></li>
</ul>
</div>
<div class="fragment">
<p><strong>Objectifs:</strong></p>
<ul>
<li><p><em>Comprendre</em> quelles variables ont une influence sur une variable quanti</p></li>
<li><p><em>Prévoir</em> les valeurs de la variable réponse dans de nouvelles conditions</p></li>
</ul>
</div>
</section>
<section id="régression-simple-vs-multiple" class="slide level2">
<h2>Régression simple vs multiple</h2>
<div class="fragment">
<ul>
<li>En régression simple, on ne considérait <em>qu’une</em> seule variable explicative</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>En régression multiple, on en considère <em>plusieurs</em> (p)</li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[\mbox{Réponse} = f(var1, \color{red}{var_2, ..., var_p}) =\underbrace{var1 + \color{red}{var_2 + ...+ var_p}}_{\mbox{régression linéaire}}\]</span></p>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i=1,...,n~~~~\varepsilon_i ~~\mbox{i.i.d.}~~,~~\mathbb{E}(\varepsilon_i)=0,~~\mathbb{V}(\varepsilon_i)=\sigma^2\\
\forall i\neq k~~~~cov(\varepsilon_i,\varepsilon_{k})=0\\
\end{array}\right.\]</span></p>
</div>
</section>
<section id="une-variable-quanti-peut-avoir-un-effet-différent-selon-différentes-modalités-dune-quali" class="slide level2">
<h2>Une variable quanti peut avoir un effet différent selon différentes modalités d’une quali</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a>ozone <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y =</span> maxO3, <span class="at">color =</span> vent))<span class="sc">+</span></span>
<span id="cb58-3"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effet de T9 sur l'ozone selon les directions du vent"</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href=""></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb58-7"><a href=""></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-53-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Cela s’écrit ainsi:</p>
<div style="font-size: 75%;">
<p><span class="math display">\[MaxO3 \sim vent + T9 + \mbox{vent:T9}\]</span></p>
<p><span class="math display">\[MaxO3_{ij} \sim \mu+\left\{ \begin{array}{l}
\alpha_{1} ~\mbox{si vent d'est} \\
\alpha_{2} ~\mbox{si vent du nord} \\
\alpha_{3} ~\mbox{si vent d'ouest} \\
\alpha_{4} ~\mbox{si vent du sud} \\
\end{array}
\right\} ~~+~~ \left(\beta+\left\{ \begin{array}{l}
\gamma_{1} ~\mbox{si vent d'est} \\
\gamma_{2} ~\mbox{si vent du nord} \\
\gamma_{3} ~\mbox{si vent d'ouest} \\
\gamma_{4} ~\mbox{si vent du sud} \\
\end{array}
\right\}\right)\times T9{ij}+ alea_{ij}\]</span> <span><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j~~~~Y_{ij}=\mu+\alpha_i+(\beta+\gamma_i)\times x_{ij} + \varepsilon_{ij}\\
\forall i,j~~~~\varepsilon_{ij} ~~\mbox{i.i.d.}~~,~~\mathbb{E}(\varepsilon_{ij})=0,~~\mathbb{V}(\varepsilon_{ij})=\sigma^2\\
\forall i,j~~~~cov(\varepsilon_{ij},\varepsilon_{i'j'})=0\\
\end{array}\right.\]</span><br>
</span></p>
</div>
</div>
</section>
<section id="interaction-entre-deux-variables-qualitatives" class="slide level2">
<h2>Interaction entre deux variables qualitatives</h2>
<div class="fragment strike">
<p><strong>Définition courante</strong>: réaction réciproque de deux phénomènes l’un sur l’autre</p>
</div>
<div class="fragment">
<p><strong>Définition statistique</strong> : l’effet d’un facteur sur Y diffère selon les modalités de l’autre facteur</p>
</div>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href=""></a><span class="fu">library</span>(dplyr)</span>
<span id="cb59-2"><a href=""></a></span>
<span id="cb59-3"><a href=""></a>ozone <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href=""></a>  <span class="fu">group_by</span>(vent, pluie) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">MOY =</span> <span class="fu">mean</span>(maxO3)) <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>vent, <span class="at">y=</span>MOY, <span class="at">col=</span>pluie, <span class="at">group=</span>pluie)) <span class="sc">+</span></span>
<span id="cb59-7"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-8"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-9"><a href=""></a>  <span class="fu">labs</span>(<span class="st">"Interaction pluie:vent sur maxO3"</span>, <span class="at">x =</span> <span class="st">"Direction du vent"</span>, <span class="at">y =</span> <span class="st">"Maximum d'ozone"</span>) <span class="sc">+</span></span>
<span id="cb59-10"><a href=""></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb59-11"><a href=""></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-54-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Cela s’écrit ainsi:</p>
<div style="font-size: 73%;">
<p><span><span class="math display">\[MaxO3 \sim vent + pluie + \mbox{vent:pluie}\]</span> <span class="math display">\[MaxO3_{ijk} \sim \mu+\left\{ \begin{array}{l}
\alpha_{1} ~\mbox{si vent d'est} \\
\alpha_{2} ~\mbox{si vent du nord} \\
\alpha_{3} ~\mbox{si vent d'ouest} \\
\alpha_{4} ~\mbox{si vent du sud} \\
\end{array}
\right\} + \left\{ \begin{array}{l}
\beta_{1} ~\mbox{si pluie} \\
\beta_{2} ~\mbox{si sec} \\
\end{array}
\right\} +
\left\{ \begin{array}{l}
\alpha\beta_{11} ~\mbox{si vent d'est ET pluie} \\
\alpha\beta_{12} ~\mbox{si vent d'est ET sec} \\
\alpha\beta_{21} ~\mbox{si vent du nord ET pluie} \\
\cdots
\alpha\beta_{42} ~\mbox{si vent du sud ET sec} \\
\end{array}
\right\} + alea_{ijk}\]</span></span> <span><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j,k~~~~Y_{ijk}=\mu+\alpha_i+\beta_j +\alpha\beta_{ij} +\varepsilon_{ijk}\\
\forall i,j,k~~~~\varepsilon_{ijk} ~~\mbox{i.i.d.}~~,~~\mathbb{E}(\varepsilon_{ijk})=0,~~\mathbb{V}(\varepsilon_{ijk})=\sigma^2\\
\forall i,j,k~~~~cov(\varepsilon_{ijk},\varepsilon_{i'j'k'})=0\\
\end{array}\right.\]</span><br>
</span></p>
</div>
</div>
</section>
<section class="slide level2">

<p><strong>Quatres types d’effet possibles</strong></p>
<div style="font-size: 75%;">
<div data-layout-nrow="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb60-2"><a href=""></a></span>
<span id="cb60-3"><a href=""></a>ozone <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y =</span> maxO3)) <span class="sc">+</span></span>
<span id="cb60-5"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-6"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"lm"</span>, <span class="at">se=</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quanti sur quanti"</span>)</span>
<span id="cb60-8"><a href=""></a>ozone <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vent, <span class="at">y =</span> maxO3, <span class="at">color =</span> vent)) <span class="sc">+</span></span>
<span id="cb60-10"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">position=</span> <span class="fu">position_jitter</span>(<span class="at">width =</span>.<span class="dv">05</span>, <span class="at">height=</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb60-11"><a href=""></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span> .<span class="dv">3</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb60-12"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quali sur quanti"</span>) <span class="sc">+</span></span>
<span id="cb60-13"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell fragment" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-55-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell fragment" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-56-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61" data-cap-location="top"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a>ozone <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T9, <span class="at">y =</span> maxO3, <span class="at">color =</span> vent))<span class="sc">+</span></span>
<span id="cb61-3"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quali / quanti sur quanti"</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href=""></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb61-7"><a href=""></a>ozone <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href=""></a>  <span class="fu">group_by</span>(vent, pluie) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">MOY =</span> <span class="fu">mean</span>(maxO3)) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>vent, <span class="at">y=</span>MOY, <span class="at">col=</span>pluie, <span class="at">group=</span>pluie)) <span class="sc">+</span></span>
<span id="cb61-11"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-12"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-13"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quali / quali sur quanti"</span>) <span class="sc">+</span></span>
<span id="cb61-14"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell fig-cap-location-top" data-layout-align="center">

</div>
<div class="cell fig-cap-location-top fragment" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-57-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell fragment" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-58-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="les-modèles-linéaires" class="slide level2">
<h2>Le(s) modèle(s) linéaire(s)</h2>
<div class="fragment">
<blockquote>
<p>Le modèle linéaire peut souvent être adapté à des problèmes issu du vivant, modulo quelques points de vigilance</p>
</blockquote>
</div>
<div class="fragment">
<table class="caption-top">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Réponse</strong></td>
<td style="text-align: left;"><strong>Variable(s) explicative(s)</strong></td>
<td style="text-align: left;"><strong>Méthode</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Var. quantitative</td>
<td style="text-align: left;">1 var. quantitative</td>
<td style="text-align: left;">régression linéaire simple</td>
</tr>
<tr class="even">
<td style="text-align: left;">Var. quantitative</td>
<td style="text-align: left;">1 var. qualitative à <span class="math inline">\(I\)</span> modalités</td>
<td style="text-align: left;">analyse de variance à 1 facteur (rq: si <span class="math inline">\(I=2\)</span> équivaut à comparaison de 2 moyennes)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Var. quantitative</td>
<td style="text-align: left;"><span class="math inline">\(p\)</span> var. quantitatives</td>
<td style="text-align: left;">régression linéaire multiple</td>
</tr>
<tr class="even">
<td style="text-align: left;">Var. quantitative</td>
<td style="text-align: left;"><span class="math inline">\(K\)</span> var. qualitatives</td>
<td style="text-align: left;">analyse de variance à <span class="math inline">\(K\)</span> facteurs</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Var. quantitative</td>
<td style="text-align: left;">var. quantitatives et qualitatives</td>
<td style="text-align: left;">analyse de covariance</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="color: lightgray">Var. qualitative (2 catégories)</span></td>
<td style="text-align: left;"><span style="color: lightgray">var. quantitatives et qualitatives</span></td>
<td style="text-align: left;"><span style="color: lightgray">régression logistique</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style="color: lightgray">Var. qualitative (K catégories)</span></td>
<td style="text-align: left;"><span style="color: lightgray">var. quantitatives et qualitatives</span></td>
<td style="text-align: left;"><span style="color: lightgray">régression multinomiale</span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="re-remettons-les-mains-dans-le-cambouis" class="slide level2">
<h2>(Re-Re)mettons les mains dans le cambouis</h2>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i=1,...,n~~~~Y_i=\color{red}{\beta_0}+\color{red}{\beta_1}x_{i1}+\color{red}{\beta_2}x_{i2}+\color{red}{\beta_3}x_{i3}+...+\color{red}{\beta_p}x_{ip} + \varepsilon_{i}\\
\forall i=1,...,n~~~~\varepsilon_i ~~\mbox{i.i.d.}~~,~~\mathbb{E}(\varepsilon_i)=0,~~\mathbb{V}(\varepsilon_i)=\sigma^2\\
\forall i\neq k~~~~cov(\varepsilon_i,\varepsilon_{k})=0\\
\end{array}\right.\]</span><br>
<span style="color: red">(p+1) paramètres à estimer</span> + 1 paramètre de variance <span class="math inline">\(\sigma^2\)</span></p>
<div class="fragment">
<p><strong>Matriciellement</strong> : <span class="math inline">\(\displaystyle{Y=X\beta+E~~~~\mbox{avec}~~\mathbb{E}(E)=0,~~\mathbb{V}(E)=\sigma^2 Id}\)</span></p>
<p><span class="math display">\[\left(
\begin{array}{c}
Y_1\\
\vdots \\
Y_i \\
\vdots \\
Y_n \\
\end{array} \right) =
\overset{{\color{gray}{\begin{matrix}{\beta_0}  &amp; {\beta_1}&amp; \beta_2&amp;\ldots &amp;\beta_p\end{matrix}}}}{
\left(
\begin{array}{cccccc}
1 &amp; x_{11} &amp; x_{12}&amp; \cdots &amp; x_{1p}\\
\vdots &amp; &amp; \vdots&amp; &amp; \vdots \\
1 &amp; x_{i1} &amp; x_{i2}&amp; &amp; x_{ip} \\
\vdots &amp; \vdots &amp; \vdots&amp; &amp; \vdots \\
1 &amp; x_{n1} &amp; x_{n2}&amp; \cdots &amp; x_{np}\\
\end{array} \right)}
\left(
\begin{array}{c}
\color{red}{\beta_0}\\
\color{red}{\beta_1}\\
\color{red}{\beta_2} \\
\vdots \\
\color{red}{\beta_p} \\
\end{array} \right) +
\left(
\begin{array}{c}
\varepsilon_1\\
\vdots \\
\varepsilon_i \\
\vdots \\
\varepsilon_n \\
\end{array} \right)\]</span></p>
</div>
<div class="fragment">
<p>Rq: ANOVA et ANCOVA peuvent aussi s’écrire sous cette forme.</p>
<div style="font-size: 95%;">
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="anova">ANOVA</h3>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j,k~~~~Y_{ijk}=\color{red}{\mu}+\color{red}{\alpha_i}+\color{red}{\beta_j} +\color{red}{\alpha\beta_{ij}} +\varepsilon_{ijk}\\
\forall i,j,k~~~~\varepsilon_{ijk} ~~\mbox{i.i.d.}~~,~~\mathbb{E}(\varepsilon_{ijk})=0,~~\mathbb{V}(\varepsilon_{ijk})=\sigma^2\\
\forall i,j,k~~~~cov(\varepsilon_{ijk},\varepsilon_{i'j'k'})=0\\
\end{array}\right.\]</span></p>
</div><div class="column" style="width:50%;">
<h3 id="ancova">ANCOVA</h3>
<p><span class="math display">\[\left\{
\begin{array}{l}
\forall i,j~~~~Y_{ij}=\color{red}{\mu}+\color{red}{\alpha_i}+(\color{red}{\beta}+\color{red}{\gamma_i})\times x_{ij} + \varepsilon_{ij}\\
\forall i,j~~~~\varepsilon_{ij} ~~\mbox{i.i.d.}~~,~~\mathbb{E}(\varepsilon_{ij})=0,~~\mathbb{V}(\varepsilon_{ij})=\sigma^2\\
\forall i,j~~~~cov(\varepsilon_{ij},\varepsilon_{i'j'})=0\\
\end{array}\right.\]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="estimation-des-paramètres-du-modèle" class="slide level2">
<h2>Estimation des paramètres du modèle</h2>
<p><strong>Critère des moindres carrés</strong>: estimer les paramétres en minimisant la somme des carrés des écarts entre observations et prévisions par le modéle</p>
<!-- %\uncover<2->{ \scriptsize -->
<!-- %Dérivée matricielle par rapport é $\beta$ (régles de dérivation: $\frac{\partial (A'Z)}{\partial A} =\frac{\partial (Z'A)}{\partial A}=Z$) -->
<!-- % -->
<!-- %\vskip -0.5cm -->
<!-- % -->
<!--    %\begin{eqnarray*} -->
<!--    %0&=&\frac{\partial\|Y-X\beta\|^2}{\partial \beta} = \frac{\partial (Y-X\beta)'(Y-X\beta)}{\partial \beta} \\ -->
<!--    %&=& \frac{\partial (Y'Y-Y'X\beta-\beta'X'Y+\beta'X'X\beta)}{\partial \beta} =-X'Y-X'Y+X'X\beta+X'X\beta\\ -->
<!-- %&\Longrightarrow  &X^{\prime}X \hat\beta = X^{\prime}Y\\ -->
<!--    %\end{eqnarray*} -->
<!-- % -->
<!--    %\vskip -1cm -->
<!-- %} -->
<div class="fragment">
<p><span class="math display">\[Y\approx X\beta\]</span> <span class="math display">\[X'Y\approx X'X\beta\]</span> <span class="math display">\[\color{red}{\hat\beta = (X^{\prime}X)^{-1}X^{\prime}Y} ~~\mbox{si }X^{\prime}X\mbox{ est inversible}\]</span></p>
<p><strong>Propriétés</strong> <span class="math inline">\(\mathbb{E}(\hat\beta)=\beta; \ \mathbb{V}(\hat\beta)=(X^{\prime}X)^{-1}\sigma^2\)</span></p>
</div>
<div class="fragment">
<p>La variance des résidus <span class="math inline">\(\sigma^2\)</span> est estimée par: <span class="math display">\[\hat \sigma^2=\frac{\sum_{i}(Y_{i}-\hat Y_{i})^2}{\mbox{nb données} - \mbox{nb paramétres estimés é  partir des données}}~~~~~~~~~~\mathbb{E}(\hat\sigma^2)=\sigma^2\]</span></p>
</div>
</section>
<section id="décomposition-de-la-variabilité-bis" class="slide level2">
<h2>Décomposition de la variabilité (bis)</h2>
<div class="fragment">
<table class="caption-top">
<tbody>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle{\sum_{i=1}^n(y_i-\bar y)^2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(= \displaystyle{\sum_{i=1}^n(\hat y_i-\bar y)^2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(+ \displaystyle{\sum_{i=1}^n(y_i-\hat y_i)^2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Variabilité</td>
<td style="text-align: center;">totale</td>
<td style="text-align: center;">modèle</td>
<td style="text-align: center;">résiduelle</td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<p><strong>Pourcentage de variabilité de</strong> <span class="math inline">\(Y\)</span> expliquée par le modèle: <span class="math inline">\(R^2 = \frac{SC_{modele}}{SC_{totale}}\)</span></p>
<p>Propriétés: <span class="math inline">\(R^2 \in [0,1]\)</span>.</p>
</div>
<div class="fragment">
<p>La variabilité du modèle peut être décomposée par variable de 2 façons:</p>
<ul>
<li><p>en calculant la variabilité expliquée par chaque variable les unes aprés les autres (pb : la variabilité d’une variable dépend de l’ordre d’introduction des variables)</p></li>
<li><p>en calculant la variabilité expliquée exclusivement par une variable (pb : la somme des variabilités de toutes les variables n’est pas égale à la variabilité du modèle)</p></li>
</ul>
</div>
<div class="fragment">
<p>Dans certains cas (données équilibrées), la variabilité du modéle se décompose parfaitement et ces 2 calculs donnent les mêmes résultats.</p>
</div>
</section>
<section id="exemple-sur-ozone" class="slide level2">
<h2>Exemple sur ozone</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href=""></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb62-2"><a href=""></a><span class="fu">LinearModel</span>(maxO3<span class="sc">~</span>T9<span class="sc">+</span>T12<span class="sc">+</span>T15<span class="sc">+</span>Ne9<span class="sc">+</span>Ne12<span class="sc">+</span>Ne15<span class="sc">+</span>Vx9<span class="sc">+</span>Vx12<span class="sc">+</span>Vx15<span class="sc">+</span>maxO3v<span class="sc">+</span>vent<span class="sc">+</span>pluie, <span class="at">data =</span>ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
LinearModel(formula = maxO3 ~ T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + 
    Vx9 + Vx12 + Vx15 + maxO3v + vent + pluie, data = ozone)

Residual standard error: 14.51 on 97 degrees of freedom
Multiple R-squared:  0.7686 
F-statistic: 23.01 on 14 and 97 DF,  p-value: 8.744e-25 
AIC =   613    BIC = 653.8

Ftest
               SS df     MS F value    Pr(&gt;F)
T9            0.2  1    0.2  0.0011   0.97325
T12         376.0  1  376.0  1.7868   0.18445
T15          30.3  1   30.3  0.1439   0.70526
Ne9        1016.5  1 1016.5  4.8312   0.03033
Ne12         37.9  1   37.9  0.1803   0.67208
Ne15          0.1  1    0.1  0.0003   0.98680
Vx9          50.2  1   50.2  0.2388   0.62619
Vx12         35.7  1   35.7  0.1697   0.68127
Vx15        122.6  1  122.6  0.5826   0.44715
maxO3v     5560.4  1 5560.4 26.4261 1.421e-06
vent        297.8  3   99.3  0.4718   0.70267
pluie       182.9  1  182.9  0.8694   0.35344
Residuals 20410.2 97  210.4                  

Ttest
               Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)   20.762962  15.461879  1.3428   0.18245
T9             0.039170   1.164957  0.0336   0.97325
T12            1.972574   1.475705  1.3367   0.18445
T15            0.450308   1.187073  0.3793   0.70526
Ne9           -2.109755   0.959855 -2.1980   0.03033
Ne12          -0.605592   1.426338 -0.4246   0.67208
Ne15          -0.017178   1.035894 -0.0166   0.98680
Vx9            0.482609   0.987624  0.4887   0.62619
Vx12           0.513795   1.247167  0.4120   0.68127
Vx15           0.726623   0.951976  0.7633   0.44715
maxO3v         0.344378   0.066991  5.1406 1.421e-06
vent - Est    -2.874041   5.157999 -0.5572   0.57867
vent - Nord   -2.334477   2.890844 -0.8075   0.42133
vent - Ouest   2.662276   3.658288  0.7277   0.46853
vent - Sud     2.546243   3.061435  0.8317   0.40761
pluie - Pluie -1.623565   1.741257 -0.9324   0.35344
pluie - Sec    1.623565   1.741257  0.9324   0.35344</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a><span class="co"># LinearModel(maxO3 ~. , data=  ozone) ## Ecriture simplifiée</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test-de-leffet-dune-ou-plusieurs-variables" class="slide level2">
<h2>Test de l’effet d’une ou plusieurs variables</h2>
<p>L’ensemble de variables <span class="math inline">\({\mathcal V}\)</span> apporte-t-il des informations complémentaires intéressantes sachant que les autres variables sont déjé dans le modèle ?</p>
<p><strong>Hypothèses</strong> : <span class="math inline">\(H_0\)</span>:“tous les coefficients associés aux variables de <span class="math inline">\({\mathcal V}\)</span> sont égaux à 0” contre <span class="math inline">\(H_1\)</span> : “au moins un coefficient des variables <span class="math inline">\({\mathcal V} \neq\)</span> 0</p>
<p><strong>Statistique de test:</strong> <span class="math inline">\(\displaystyle{F_{obs}=\frac{SC_{\mathcal V}/ddl_{\mathcal V}}{SC_R/ddl_R}=\frac{CM_{\mathcal V}}{CM_R} }\)</span></p>
<p><strong>Loi de la statistique de test:</strong> Sous <span class="math inline">\(H_0\)</span>, <span class="math inline">\({\mathcal L}(F_{obs}) = {\mathcal F}_{ddl_R}^{ddl_{\mathcal V}}\)</span></p>
<p><strong>Décision</strong> : <span class="math inline">\(\mathbb{P}({\mathcal F}_{ddl_{\mathcal V}}^{ddl_R}&gt;F_{obs}) &lt; 0.05\ \ \Longrightarrow\)</span> Rejet de <span class="math inline">\(H_0\)</span></p>
<div class="fragment">
<div>
<ul>
<li class="fragment"><p>Revient à choisir entre le sous-modèle sans les variables <span class="math inline">\({\mathcal V}\)</span> ou le modèle complet</p></li>
<li class="fragment"><p>Si <span class="math inline">\({\mathcal V}\)</span> contient tous les effets : revient à tester si <span class="math inline">\(R^2\)</span> est significativement différent de 0, i.e.&nbsp;si toutes les variables sont inutiles (versus au moins une utile)</p></li>
<li class="fragment"><p>On somme les degrés de liberté associés é l’ensemble <span class="math inline">\({\mathcal V}\)</span> sachant qu’1 variable quanti à 1 ddl, 1 variable quali à <span class="math inline">\(I-1\)</span> ddl et une interaction a comme ddl le produit des ddl de chaque facteur</p></li>
</ul>
</div>
<!-- \tiny $\Longrightarrow$ Pour la séance de TD écrire le test pour 1 variable quali, celui pour 1 interaction, celui pour le test de toutes les variables -->
<!-- * On teste le plus souvent ${\mathcal V}$ avec 1 variable ou avec toutes les variables -->
</div>
</section>
<section id="sélection-de-variables" class="slide level2">
<h2>Sélection de variables</h2>
<p>Sélection de modèle = trouver un compromis entre un modèle qui s’ajuste bien aux données et qui n’a pas “trop” de paramètres (Rappel: <i class="fa-solid fa-dollar-sign fa-1xl" aria-label="dollar-sign"></i> <i class="fa-solid fa-cake-candles fa-1xl" aria-label="cake-candles"></i>)</p>
<div class="fragment">
<ul>
<li><a href="https://scholar.google.fr/scholar?hl=fr&amp;as_sdt=0%2C5&amp;q=model+selection&amp;btnG=" style="color:blue;">Enorme littérature sur le sujet</a></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/model_selection.PNG" class="quarto-figure quarto-figure-center" width="550" height="70"></p>
</figure>
</div>
</div>
<div class="fragment">
<ul>
<li>Souvent utilisé: sélection du modèle qui minimise l’AIC / BIC: compromis entre maximisation de la vraisemblance <span class="math inline">\(L\)</span> (à quel point le modèle s’ajuste bien aux données) et le nb de paramètres</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><span class="math inline">\(AIC = 2p - 2ln(\hat{L})\)</span></p>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><span class="math inline">\(BIC = pln(n) - 2ln(\hat{L})\)</span></p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><i class="fa-solid fa-question fa-1xl" aria-label="question"></i> A votre avis, quelle est la différence entre les 2 critères (<i class="bi-pencil " style="font-size: 1.5em;" role="img" aria-hidden="true"></i> <i class="bi-journal-text " style="font-size: 1.5em;" role="img" aria-hidden="true"></i> !)</p>
</div>
<div class="fragment">
<div style="font-size: 85%;">
<p><strong>Plusieurs stratégies</strong></p>
<ul>
<li>Construction exhaustive de tous les sous-modèles (long et même impossible si trop de variables)</li>
<li>Méthode descendante (backward): construire le modéle complet; supprimer la variable explicative la moins intéressante et reconstruire le modèle sans cette variable; itérer jusqu’à ce que toutes les variables explicatives soient intéressantes</li>
<li>Méthode ascendante (forward): partir du modéle avec la variable la plus intéressante; ajouter la variable qui, connaissant les autres variables du modèle, apporte le plus d’information complémentaire; itérer jusqu’é ce qu’aucune variable n’apporte d’information intéressante</li>
<li>Méthode stepwise: compromis entre les 2 méthodes ci-dessus</li>
</ul>
</div>
</div>
</section>
<section id="exemple-sur-ozone-sélection-de-variables" class="slide level2">
<h2>Exemple sur ozone: sélection de variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href=""></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb65-2"><a href=""></a><span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>  ., <span class="at">data =</span> ozone, <span class="at">selection =</span> <span class="st">"bic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results for the complete model:
==============================
Call:
LinearModel(formula = maxO3 ~ ., data = ozone, selection = "bic")

Residual standard error: 14.51 on 97 degrees of freedom
Multiple R-squared:  0.7686 
F-statistic: 23.01 on 14 and 97 DF,  p-value: 8.744e-25 
AIC =   613    BIC = 653.8

Results for the model selected by BIC criterion:
===============================================
Call:
LinearModel(formula = maxO3 ~ T12 + Ne9 + Vx9 + maxO3v, data = ozone, 
    selection = "bic")

Residual standard error: 14 on 107 degrees of freedom
Multiple R-squared:  0.7622 
F-statistic: 85.75 on 4 and 107 DF,  p-value: 1.763e-32 
AIC =   596    BIC = 609.6

Ftest
               SS  df     MS F value    Pr(&gt;F)
T12        6650.4   1 6650.4 33.9334 6.073e-08
Ne9        2714.8   1 2714.8 13.8522 0.0003172
Vx9         903.4   1  903.4  4.6094 0.0340547
maxO3v     7363.5   1 7363.5 37.5721 1.499e-08
Residuals 20970.2 107  196.0                  

Ttest
             Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept) 12.631310  11.000877  1.1482 0.2534427
T12          2.764090   0.474502  5.8252 6.073e-08
Ne9         -2.515402   0.675845 -3.7219 0.0003172
Vx9          1.292857   0.602180  2.1470 0.0340547
maxO3v       0.354832   0.057888  6.1296 1.499e-08</code></pre>
</div>
</div>
</section>
<section id="démarche-en-modélisation" class="slide level2">
<h2>Démarche en modélisation</h2>
<div>
<ol type="1">
<li class="fragment"><p>Lister les variables potentiellement explicatives / prédictives</p></li>
<li class="fragment"><p>Visualiser</p></li>
<li class="fragment"><p>Selectionner le sous-modèle (minimisation de l’AIC ou du BIC)</p></li>
<li class="fragment"><p><span style="color:DarkGray;">Interpréter les résultats (quelles variables ressortent ? Est-ce surprenant ? Est-ce en accord avec les connaissances sur le sujet ? Des confusions possibles ?)</span></p></li>
<li class="fragment"><p><span style="color:DarkGray;">Interpréter les coefficients (signe, valeur etc.)</span></p></li>
<li class="fragment"><p><span style="color:DarkGray;">(Prédire pour de nouvelles valeurs)</span></p></li>
</ol>
</div>
</section>
<section id="codage-et-contraintes-pour-variables-quali" class="slide level2 scrollable">
<h2>Codage et contraintes pour variables quali</h2>
<div class="fragment">
<p>La matrice de design <span class="math inline">\(X\)</span> (dans <span class="math inline">\(Y = X\beta + E\)</span>) a autant de lignes que d’individus. Pour les colonnes, c’est variable…</p>
</div>
<div class="fragment">
<div style="font-size: 70%;">
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Constante (<span class="math inline">\(\mu\)</span> ou <span class="math inline">\(\beta_0\)</span>)</th>
<th>Variable quanti</th>
<th>Variable Quali</th>
<th>Interaction quali -quali</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Représentation dans X</td>
<td>Une colonne de 1</td>
<td>Valeur de la variable</td>
<td>(I-1) colonnes par modalités de chaque variable à I modalités</td>
<td>(I-1)*(J-1) colonnes</td>
</tr>
<tr class="even">
<td>Degrés de libertés (ddl)</td>
<td>1</td>
<td>1</td>
<td>I-1</td>
<td>(I-1)*(J-1)</td>
</tr>
<tr class="odd">
<td>Commentaires</td>
<td></td>
<td></td>
<td>Contrainte à poser sur les paramètres (le mieux est <span class="math inline">\(\sum_{i=1}^n \alpha_i = 0\)</span>)</td>
<td>Contrainte à poser sur les paramètres (le mieux est <span class="math inline">\(\forall i, \sum_j \alpha \beta_{ij} =0\)</span> et <span class="math inline">\(\forall j, \sum_i \alpha \beta_{ij} =0\)</span>)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><span style="color:red;">Le choix de la contrainte impacte FORTEMENT l’interprétation</span></p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div style="font-size: 75%;">
<ol type="1">
<li><span class="math inline">\(\sum_i \alpha_i= 0\)</span>, la comparaison est faite par rapport à la moyenne des moyennes par modalité</li>
<li><span class="math inline">\(\alpha_1= 0\)</span>, la comparaison est faite par rapport à un niveau de ref (<em>moins intuitif, et pas pratique quand présence d’interactions</em>)</li>
</ol>
</div>
</div>
<div class="fragment">
<div style="font-size: 75%;">
<p><em>Certaines fonctions de R par défaut utilisent la contrainte 2. !</em></p>
</div>
</div>
<div class="fragment">
<div style="font-size: 75%;">
<p>Comparez les sorties de ces différentes lignes de code…</p>
</div>
<div class="columns">
<div class="column" style="width:20%;">
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href=""></a><span class="co">#lm par défaut</span></span>
<span id="cb67-2"><a href=""></a><span class="fu">coef</span>( <span class="fu">lm</span>(maxO3 <span class="sc">~</span> pluie,</span>
<span id="cb67-3"><a href=""></a>         <span class="at">data=</span> ozone) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    pluieSec 
   73.39535    27.44523 </code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href=""></a><span class="co">#lm en spécifiant le contraste</span></span>
<span id="cb69-2"><a href=""></a><span class="fu">coef</span>(<span class="fu">lm</span>(maxO3 <span class="sc">~</span> pluie,</span>
<span id="cb69-3"><a href=""></a>        <span class="at">data =</span> ozone,</span>
<span id="cb69-4"><a href=""></a>        <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">pluie=</span> <span class="st">"contr.sum"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      pluie1 
   87.11796   -13.72262 </code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href=""></a><span class="co"># LinearModel prémâche le travaille</span></span>
<span id="cb71-2"><a href=""></a><span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span> pluie,</span>
<span id="cb71-3"><a href=""></a>            <span class="at">data=</span> ozone)<span class="sc">$</span>Ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)    87.11796   2.419555 36.005777 1.066479e-62
pluie - Pluie -13.72262   2.419555 -5.671545 1.156980e-07
pluie - Sec    13.72262   2.419555  5.671545 1.156980e-07</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inteprétation-des-résultats" class="slide level2">
<h2>Inteprétation des résultats</h2>
<ul>
<li><strong>Modèle sélectionné</strong> <span class="math inline">\(\Rightarrow\)</span> Interprétation des résultats</li>
</ul>
<div class="fragment">
<p><em>2 situations</em></p>
<ol type="1">
<li>Idéale: données équilibrées</li>
<li>Difficile: données déséquilibrées</li>
</ol>
</div>
<div class="fragment">
<p>Remarques:</p>
<ul>
<li>Les plans d’expériences permettent d’avoir données équilibrées</li>
<li>En ANOVA, on a souvent des données équilibrées</li>
</ul>
</div>
</section>
<section id="décomposition-de-la-variabilité-variables-quali-données-équilibrées" class="slide level2">
<h2>Décomposition de la variabilité : variables quali, données équilibrées</h2>
<p>Quand les données sont équilibrées, la décomposition de la variabilité est parfaite:</p>
<p><span class="math display">\[\begin{array}{ccl}
\displaystyle{\sum_{i,j,k}(y_{ijk}-y_{\bullet\bullet\bullet})^2}&amp;=&amp; \displaystyle{\sum_{i,j,k}\underbrace{(y_{i\bullet\bullet}-y_{\bullet\bullet\bullet})^2}_{\hat\alpha_i^2}} + \displaystyle{\sum_{i,j,k}\underbrace{(y_{\bullet  j \bullet }-y_{\bullet \bullet \bullet})^2}_{\hat\beta_j^2}}\\
&amp;&amp;+ \displaystyle{\sum_{i,j,k}\underbrace{(y_{ij\bullet }-y_{i\bullet \bullet}-y_{\bullet j\bullet}+y_{\bullet \bullet\bullet})^2}_{\widehat{\alpha\beta}_{ij}^2}}+ \displaystyle{\sum_{i,j,k}\underbrace{(y_{ijk}-y_{ij\bullet})^2}_{\varepsilon_{ijk}^2}}\\

\end{array}\]</span></p>
<div class="fragment">
<p>Quand les données sont équilibrées, les coefficients s’estiment simplement:</p>
<p><span class="math display">\[\begin{array}{c}
\hat\mu=y_{\bullet \bullet \bullet}~~~~~~~~~~~~~~~~~~~~
\forall i,~\hat\alpha_i=y_{i \bullet \bullet}-y_{\bullet \bullet \bullet}\\
\forall j,~\hat\beta_j=y_{\bullet j \bullet}-y_{\bullet \bullet \bullet}~~~~~~~~~~~~
\forall i,j~\widehat{\alpha\beta}_{ij}=y_{ij \bullet}-y_{i\bullet \bullet}-y_{\bullet j\bullet}+y_{\bullet \bullet \bullet}
\end{array}\]</span></p>
</div>
<div class="fragment">
<p><span class="math inline">\(\Longrightarrow\)</span> On quantifie parfaitement ce qui est expliqué par chaque variable ou interaction</p>
<!-- ## Décomposition de la variabilité : variables quali, données déséquilibrées -->
<!-- Retour sur un exemple montré plus haut, mais légèrement modifié... -->
<!-- . . . -->
<!-- . . . -->
<!-- Question: comment estimer $y_{2\bullet}$ ? Deux possibilités ... -->
<!-- . . . -->
<!-- Le déséquilibre induit une une confusion (alias en anglais) -->
<!-- Variables explicatives sont très corrélées $\longrightarrow$ l’interprétation est très difficile -->
</div>
</section>
<section id="comparaison-de-moyennes-ajustées" class="slide level2">
<h2>Comparaison de moyennes ajustées</h2>
<p>Moyennes ajustées = <span class="math inline">\(\hat{\mu} + \hat{\alpha}_i\)</span>: Permet de s’affranchir de l’effet des autres variables</p>
<div class="fragment">
<p>Comparaisons possibles 2 à 2, moyennant une correction de Bonferroni par ex.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href=""></a>data_choco <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"data/chocolat_2022.csv"</span>, <span class="at">sep =</span> <span class="st">";"</span>)</span>
<span id="cb73-2"><a href=""></a>mod <span class="ot">&lt;-</span> <span class="fu">LinearModel</span>(Sucree<span class="sc">~</span>Produit<span class="sc">+</span>Juge<span class="sc">+</span>Produit<span class="sc">:</span>Juge, <span class="at">data=</span>data_choco)</span>
<span id="cb73-3"><a href=""></a><span class="fu">meansComp</span>(mod,<span class="sc">~</span>Produit, <span class="at">adjust=</span><span class="st">"bonferonni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-64-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$adjMean
 Produit      emmean    SE  df lower.CL upper.CL
 CoteOr_bio70   4.50 0.264 118     3.75     5.25
 CoteOr_bio85   2.42 0.275 118     1.63     3.20
 Equador72      3.88 0.264 118     3.12     4.63
 Lindt70        4.79 0.264 118     4.04     5.55
 Lindt78        4.29 0.264 118     3.54     5.05
 Lindt85        2.58 0.264 118     1.83     3.34
 Repere_bio74   3.88 0.275 118     3.09     4.66
 Repere_bio85   2.46 0.264 118     1.70     3.21
 Villars72      5.54 0.264 118     4.79     6.30
 Villars85      3.17 0.264 118     2.41     3.92

Results are averaged over the levels of: Juge 
Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 10 estimates 

$groupComp
CoteOr_bio85 Repere_bio85      Lindt85    Villars85    Equador72 Repere_bio74 
         "a"          "a"          "a"         "ab"         "bc"         "bc" 
     Lindt78 CoteOr_bio70      Lindt70    Villars72 
        "bc"         "cd"         "cd"          "d" 

attr(,"class")
[1] "meansComp"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="prédictions" class="slide level2">
<h2>Prédictions</h2>
<p><span class="math inline">\(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}x_{i1} + \hat{\beta_2}x_{i2}  + ... + \hat{\beta_p}x_{ip}\)</span></p>
<p>Prédire Y pour : (T12=19, Ne9=8, Vx9=1.2, maxO3v=70) et (T12=23, Ne9=10, Vx9=0.9, maxO3v=95)</p>
<div class="fragment">
<p>Sur PC:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href=""></a>model <span class="ot">&lt;-</span> <span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>  ., <span class="at">data =</span> ozone, <span class="at">selection =</span> <span class="st">"bic"</span>)</span>
<span id="cb75-2"><a href=""></a></span>
<span id="cb75-3"><a href=""></a>xnew <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">T12=</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">23</span>), <span class="at">Ne9=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">10</span>), <span class="at">Vx9=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.9</span>), <span class="at">maxO3v=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">95</span>))</span>
<span id="cb75-4"><a href=""></a><span class="fu">predict</span>(model,xnew,<span class="at">interval=</span><span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr       upr
1 71.41544 42.90026  99.93063
2 85.92393 56.76803 115.07983</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href=""></a><span class="fu">predict</span>(model,xnew,<span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 71.41544 64.86327 77.96761
2 85.92393 76.98627 94.86159</code></pre>
</div>
</div>
</div>
</section>
<section id="analyse-des-résidus" class="slide level2">
<h2>Analyse des résidus</h2>
<ul>
<li><p>Les résidus sont la part du phénomène non-expliquée par le modèle</p></li>
<li><p>On peut vérifier les hypothèses initiales du modèle</p></li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-66-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(&gt;F)
group   3  1.5589 0.2036
      108               </code></pre>
</div>
</div>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Test de Shapiro-Wilk de normalité des Résidus (Rq : la non-normalité n’est pas un pb tant que la distribution est symétrique)</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lesson_demarche_stat_files/figure-revealjs/unnamed-chunk-67-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  res
W = 0.97117, p-value = 0.01587</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="retour-sur-lexemple-ozone" class="slide level2">
<h2>Retour sur l’exemple ozone</h2>
<div class="fragment">
<ul>
<li>Maximum d’ozone : variable réponse</li>
<li>Les variables de températures, nébulosité, vitesse de vent (quanti), et la direction et la pluie (quali) sont prises en compte</li>
<li>On ne sait pas si les interactions entre variables quali et entre les variables quali et quanti sont négligeables <span class="math inline">\(\Longrightarrow\)</span> on les met dans le modèle</li>
</ul>
</div>
<div class="fragment">
<p><code>LinearModel(maxO3 ~ (T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + pluie + vent) * (pluie + vent), data=ozone, selection="bic")</code></p>
<p>Ce qui revient à écrire :</p>
<p><code>maxO3 ~ T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + pluie + vent + T9:pluie + T12:pluie + T15:pluie + Ne9:pluie + Ne12:pluie + Ne15:pluie + Vx9:pluie + Vx12:pluie + Vx15:pluie + maxO3v:pluie + vent:pluie + T9:vent + T12:vent + T15:vent + Ne9:vent + Ne12:vent + Ne15:vent + Vx9:vent + Vx12:vent + Vx15:vent + maxO3v:vent</code></p>
</div>
</section>
<section id="résultat-et-sortie" class="slide level2">
<h2>Résultat et sortie</h2>
<p><code>Results for the complete model:</code></p>
<p><code>Call: LinearModel(formula = maxO3 ~ (T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + pluie + vent) * (pluie + vent), data = ozone, selection = "bic")</code></p>
<p><code>Residual standard error: 14.54 on 56 degrees of freedom</code> <code>Multiple R-squared:  0.8658</code> <code>F-statistic: 6.569 on 55 and 56 DF,  p-value: 2.585e-11</code> <code>AIC =   634    BIC = 786.2</code></p>
<p><code>Results for the model selected by BIC criterion:</code></p>
<p><code>Call:</code> <code>LinearModel(formula = maxO3 ~ T9 + T15 + Ne12 + Vx9 + maxO3v + vent + T9:vent + T15:vent, data = ozone, selection = "bic")</code></p>
<p><code>Residual standard error: 13.8 on 97 degrees of freedom</code> <code>Multiple R-squared:  0.7906</code> <code>F-statistic: 26.16 on 14 and 97 DF,  p-value: 8.082e-27</code> <code>AIC = 601.8    BIC = 642.6</code></p>
</section>
<section id="interprétation-des-résultats" class="slide level2">
<h2>Interprétation des résultats</h2>
<div class="columns">
<div class="column" style="width:&quot;60%;">
<div class="cell">
<style type="text/css">
/* size of code output, applied to everything */

.reveal pre {
  font-size: 1.5rem !important;
}
</style>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               SS df     MS F value    Pr(&gt;F)    
T9          606.2  1  606.2  3.1841 0.0774866 .  
T15         252.8  1  252.8  1.3278 0.2520220    
Ne12       2107.0  1 2107.0 11.0664 0.0012425 ** 
Vx9        1657.3  1 1657.3  8.7046 0.0039790 ** 
maxO3v     5160.8  1 5160.8 27.1060 1.078e-06 ***
vent         12.5  3    4.2  0.0218 0.9956079    
T9:vent    2587.1  3  862.4  4.5294 0.0051335 ** 
T15:vent   3722.1  3 1240.7  6.5165 0.0004613 ***
Residuals 18468.3 97  190.4                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div><div class="column" style="width:&quot;40%;">
<p>On peut dire (à partir des effets significatifs) qu’il y a, sur le max d’O3:</p>
<ul>
<li>des effets de nébulosité de vitesse de vent, du maximum d’O3 de la veille</li>
<li>des effets de la direction du vent et des températures mais à travers les interactions : la direction du vent modifie l’effet de la T<span class="math inline">\(^o\)</span> (i.e.&nbsp;amplifie l’effet de la T<span class="math inline">\(^o\)</span> ou la diminue selon la direction du vent) sur max O3</li>
</ul>
</div>
</div>
<div class="fragment">
<p>On peut aussi dire (à partir des absences d’effets significatifs):</p>
<ul>
<li>la pluviométrie n’est pas un facteur déterminant qui influe sur le max d’03</li>
<li>une seule nébulosité (Ne12) est conservée dans le modèle : cela ne veut pas dire que les autres nébulosités n’ont pas d’effet (elles peuvent avoir un effet similaire). Idem pour la vitesse de vent.</li>
<li>pour la T<span class="math inline">\(^o\)</span>, on a besoin des T<span class="math inline">\(^o\)</span> à 9h et à 15h pour mieux prévoir le maximum d’ozone. L’effet de la T<span class="math inline">\(^o\)</span> n’est pas exactement le même entre 9h et 15h (mais 12h n’est pas utile comme info)</li>
<li>l’effet de la nébulosité est le même quelle que soit la direction du vent. Idem pour la vitesse du vent.</li>
</ul>
</div>
</section>
<section id="interprétation-des-résultats-22" class="slide level2">
<h2>Interprétation des résultats (2/2)</h2>
<div class="columns">
<div class="column" style="width:&quot;60%;">
<div class="cell">
<style type="text/css">
/* size of code output, applied to everything */

.reveal pre {
  font-size: 1.5rem !important;
}
</style>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                     Estimate  Std. Error     t value     Pr(&gt;|t|)
(Intercept)        18.2063080 13.70594596  1.32835107 1.871790e-01
T9                  1.8269164  1.02383156  1.78439159 7.748658e-02
T15                 1.0200174  0.88518659  1.15231903 2.520220e-01
Ne12               -3.0131694  0.90577505 -3.32661998 1.242541e-03
Vx9                 2.2212608  0.75287821  2.95035871 3.978950e-03
maxO3v              0.3466961  0.06659106  5.20634637 1.078363e-06
vent - Est          0.4734242 17.01021918  0.02783175 9.778535e-01
vent - Nord         3.2973579 15.03561957  0.21930310 8.268748e-01
vent - Ouest       -1.1250216 14.00661570 -0.08032073 9.361477e-01
vent - Sud         -2.6457606 15.14886158 -0.17465079 8.617181e-01
vent - Est : T9    -4.7442269  2.14177382 -2.21509241 2.909369e-02
vent - Nord : T9    6.1407678  1.70138426  3.60927739 4.879524e-04
vent - Ouest : T9  -0.9505390  1.34553370 -0.70644010 4.816079e-01
vent - Sud : T9    -0.4460019  1.52215003 -0.29300782 7.701421e-01
vent - Est : T15    3.6809644  1.79674431  2.04868573 4.319389e-02
vent - Nord : T15  -5.2279430  1.21533621 -4.30164338 4.045444e-05
vent - Ouest : T15  0.9796886  0.93082643  1.05249333 2.951881e-01
vent - Sud : T15    0.5672899  1.11114058  0.51054741 6.108279e-01</code></pre>
</div>
</div>
</div><div class="column" style="width:&quot;40%;">
<ul>
<li>pour T9 et T15, <span class="math inline">\(\beta \ \neq\)</span> 0</li>
<li><i class="fa-solid fa-plus fa-1xl" aria-label="plus"></i> nébulosité, <i class="fa-solid fa-minus fa-1xl" aria-label="minus"></i> max d’O3 (<i class="fa-solid fa-triangle-exclamation fa-1xl" aria-label="triangle-exclamation"></i> )</li>
<li><i class="fa-solid fa-plus fa-1xl" aria-label="plus"></i> maximum d’O3 de la veille est grand, <i class="fa-solid fa-plus fa-1xl" aria-label="plus"></i> maximum d’O3 du jour</li>
<li>les jours de vents d’est et surtout du nord ont des max d’O3 supérieur aux jours de vents d’ouest et du sud</li>
<li>les jours de vent du nord, l’effet de la T<span class="math inline">\(^o\)</span> à 9h est plus important (coef <span class="math inline">\(= 6.14\)</span>); au contraire quand le vent vient de l’est. C’est l’inverse pour la T<span class="math inline">\(^o\)</span> à 15h</li>
<li>Ainsi, quand le vent du nord, l’effet de la T<span class="math inline">\(^o\)</span> à 9h est particulièrement fort (donc s’il fait chaud à 9h quand le vent vient du nord, le max d’O3 risque d’être important)</li>
<li>etc.</li>
</ul>
</div>
</div>
</section>
<section id="démarche-en-modélisation-bis" class="slide level2">
<h2>Démarche en modélisation (bis)</h2>
<div>
<ol type="1">
<li class="fragment"><p>Lister les variables potentiellement explicatives / prédictives</p></li>
<li class="fragment"><p>Visualiser</p></li>
<li class="fragment"><p>Selectionner le sous-modèle (minimisation de l’AIC ou du BIC)</p></li>
<li class="fragment"><p>Interpréter les résultats (quelles variables ressortent ? Est-ce surprenant ? Est-ce en accord avec les connaissances sur le sujet ? Des confusions possibles ?</p></li>
<li class="fragment"><p>Interpréter les coefficients (signe, valeur etc.)</p></li>
<li class="fragment"><p>Prédire pour de nouvelles valeurs</p></li>
</ol>
</div>
</section></section>
<section>
<section id="travaux-dirigés" class="title-slide slide level1 center">
<h1>Travaux dirigés</h1>

</section>
<section id="liste-de-messages-derreurs-communs" class="slide level2">
<h2>Liste de messages d’erreurs communs</h2>
<div class="cell">
<style type="text/css">
/* size of code output, applied to everything */

.reveal pre {
  font-size: 0.7rem !important;
}
</style>
</div>
<div style="font-size: 70%;">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><em>Erreur dans file(file, “rt”) : impossible d’ouvrir la connexion</em>:
<ul>
<li><strong>Nom du fichier mal spécifié</strong></li>
<li><strong>Chemin mal spécifié (vérifiez le projet dans lequel vous êtes en haut à droite)</strong></li>
</ul></li>
</ul>
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href=""></a><span class="fu">read.table</span>(<span class="st">"https://r-stat-sc-donnees.github.io/ozone.tx"</span>,</span>
<span id="cb83-2"><a href=""></a>           <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span style="color:gray;"><em>Erreur dans file(file, “rt”) : impossible d’ouvrir la connexion vers ‘https://r-stat-sc-donnees.github.io/ozone.tx’</em></span></p>
<ul>
<li><em>objet xxx introuvable</em> <span class="math inline">\(\Rightarrow\)</span> <strong>objet non chargé (vérifiez votre environnement)</strong></li>
</ul>
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href=""></a><span class="fu">head</span>(ozone, <span class="at">n=</span> <span class="dv">1</span>)</span>
<span id="cb84-2"><a href=""></a>ozone <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"https://r-stat-sc-donnees.github.io/ozone.txt"</span>,</span>
<span id="cb84-3"><a href=""></a>                    <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-4"><a href=""></a><span class="fu">head</span>(ozone, <span class="at">n=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><em>impossible de trouver la fonction xxx</em> <span class="math inline">\(\Rightarrow\)</span> <strong>Package non chargé / fonction mal orthographiée (R esT SeNSiBle A La CAsSe !)</strong></li>
</ul>
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href=""></a><span class="fu">LinearModel</span>(maxO3 <span class="sc">~</span>pluie, <span class="at">data =</span> ozone) <span class="co"># package pas chargé</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in LinearModel(maxO3 ~ pluie, data = ozone): impossible de trouver la fonction "LinearModel"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href=""></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb87-2"><a href=""></a><span class="fu">Linearmodel</span>(maxO3 <span class="sc">~</span>pluie, <span class="at">data =</span> ozone) <span class="co"># oubli majuscule à model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in Linearmodel(maxO3 ~ pluie, data = ozone): impossible de trouver la fonction "Linearmodel"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href=""></a><span class="co">#LinearModel(maxO3 ~pluie, data = ozone) # marche</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<ul>
<li>Pas de message mais un <code>+</code> qui apparaît dans la console <span class="math inline">\(\Rightarrow\)</span> Vous n’avez pas fermé chaque parenthèse ouverte
<ul>
<li>Appuyer sur Echap après s’être mis dans la console</li>
<li>Corriger code</li>
</ul></li>
</ul>
<div class="cell my_class_code_small">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r my_class_code_small number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href=""></a><span class="co"># (mean(c(1:3))</span></span>
<span id="cb90-2"><a href=""></a></span>
<span id="cb90-3"><a href=""></a><span class="co"># Ceci s'affiche dans la console</span></span>
<span id="cb90-4"><a href=""></a><span class="co"># &gt; (mean(c(1:3))</span></span>
<span id="cb90-5"><a href=""></a><span class="co">#+ </span></span>
<span id="cb90-6"><a href=""></a></span>
<span id="cb90-7"><a href=""></a><span class="co"># marche</span></span>
<span id="cb90-8"><a href=""></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<ul>
<li>Souvenez-vous…</li>
</ul>
<p><img data-src="images/puppy_click.jpg"></p>
</div>
</div>
</div>
<!-- Thank CHAT GPT -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Obtenir toutes les sections avec un H1, en excluant le premier H1 (le titre de la présentation)
  const h1Elements = Array.from(document.querySelectorAll('h1')).slice(1); // On exclut le premier H1
  const sectionTitles = h1Elements.map(h1 => h1.textContent);

  // Créer des éléments de titre pour chaque section (H1 uniquement, sauf le premier)
  const titleContainer = document.createElement('div');
  titleContainer.classList.add('title-container');
  sectionTitles.forEach((title, index) => {
    const titleElement = document.createElement('span');
    titleElement.classList.add('section-title');
    titleElement.textContent = title;
    titleElement.setAttribute('data-section-index', index);

    // Rendre chaque titre cliquable pour naviguer vers la section correspondante
    titleElement.style.cursor = 'pointer'; // Ajouter le style du curseur pour indiquer que c'est cliquable
    titleElement.addEventListener('click', () => {
      // Récupérer la diapositive correspondant au H1 sélectionné
      const targetSlide = h1Elements[index].closest('section');
      const indices = Reveal.getIndices(targetSlide); // Obtenir les indices de la section (index horizontal et vertical)
      Reveal.slide(indices.h, indices.v); // Naviguer vers la section correspondante
    });

    titleContainer.appendChild(titleElement);
  });

  document.body.insertBefore(titleContainer, document.body.firstChild); // Affiche les titres en haut de la page

  function updateSectionTitles() {
    const currentSlide = Reveal.getCurrentSlide();

    // Vérifier si la diapositive actuelle contient un H1, en excluant le premier
    let currentSectionIndex = -1;
    h1Elements.forEach((h1, index) => {
      if (currentSlide.contains(h1)) {
        currentSectionIndex = index;
      }
    });

    if (currentSectionIndex === -1) {
      return; // Ne rien faire si aucun H1 n'est trouvé dans la diapositive courante
    }

    // Mise à jour du style des titres selon la section courante
    const titleElements = document.querySelectorAll('.section-title');
    titleElements.forEach((titleElement, index) => {
      if (index === currentSectionIndex) {
        titleElement.style.color = 'black'; // Section active
        titleElement.style.opacity = 1;
      } else {
        titleElement.style.color = 'grey'; // Autres sections
        titleElement.style.opacity = 0.5;
      }
    });
  }

  Reveal.on('slidechanged', updateSectionTitles);
  updateSectionTitles(); // Initialisation au chargement
});

</script>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lesson_demarche_stat_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lesson_demarche_stat_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>